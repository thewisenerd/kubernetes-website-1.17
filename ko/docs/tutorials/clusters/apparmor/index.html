<!DOCTYPE html>
<html id="docs" lang="ko" class="">
	<head>
	

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-36037335-10');
</script>
<meta charset="utf-8">
<title>AppArmor - Kubernetes</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#326ce5">
<link rel="shortcut icon" type="image/png" href="/images/favicon.png">









<link rel="stylesheet" href="/css/style.b7b8403eb5b1fddd0a2da2a8383d5b53e6ef81c23e4b0e292e6103bd91f9502d.css" integrity="sha256-t7hAPrWx/d0KLaKoOD1bU&#43;bvgcI&#43;Sw4pLmEDvZH5UC0=">


<link rel="stylesheet" href="/css/base_fonts.css">
<link rel="stylesheet" href="/css/jquery-ui.min.css">
<link rel="stylesheet" href="/css/callouts.css">
<link rel="stylesheet" href="/css/custom-jekyll/tags.css">



<meta name="description" content="">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:url" content="https://kubernetes.io/ko/docs/tutorials/clusters/apparmor/">
<meta property="og:title" content="AppArmor">
<meta name="twitter:title" content="AppArmor">
<meta name="twitter:image" content="https://kubernetes.io/images/favicon.png" />

<meta name="twitter:image:alt" content="Kubernetes">

<meta property="og:image" content="/images/kubernetes-horizontal-color.png">

<meta property="og:type" content="article">
<script src="/js/anchor-4.1.1.min.js"></script>
<script src="/js/jquery-3.2.1.min.js"></script>
<script src="/js/jquery-ui-1.12.1.min.js"></script>
<script src="/js/bootstrap-4.3.1.min.js"></script>
<script src="/js/sweetalert-2.1.2.min.js"></script>

<script src="/js/script.js"></script>
<script src="/js/custom-jekyll/tags.js"></script>


	</head>
	<body>
		<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/ko/" class="logo" title="운영 수준의 컨테이너 오케스트레이션 - Kubernetes" aria-label="Kubernetes website"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            
            
            <li><a href="/ko/docs/" class="active">문서</a></li>
            
            
            
            <li><a href="/ko/training/">교육</a></li>
            
            
            
            
            
            <li><a href="/ko/case-studies/">사례 연구</a></li>
            
            
            
             <li>
                <a href="#">
                    한국어 Korean <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="/docs/tutorials/clusters/apparmor/">English</a></li>
                
                    <li><a href="/zh/docs/tutorials/clusters/apparmor/">中文 Chinese</a></li>
                
                </ul>
            </li>

            <li>
                <a href="#">
                    v1.17 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="https://kubernetes.io/ko/docs/tutorials/clusters/apparmor/">v1.21</a></li>
                
                    <li><a href="https://v1-20.docs.kubernetes.io/ko/docs/tutorials/clusters/apparmor/">v1.20</a></li>
                
                    <li><a href="https://v1-19.docs.kubernetes.io/ko/docs/tutorials/clusters/apparmor/">v1.19</a></li>
                
                    <li><a href="https://v1-18.docs.kubernetes.io/ko/docs/tutorials/clusters/apparmor/">v1.18</a></li>
                
                    <li><a href="https://v1-17.docs.kubernetes.io/ko/docs/tutorials/clusters/apparmor/">v1.17</a></li>
                
                </ul>
            </li>
        </ul>
        
        <a href="/ko/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>쿠버네티스 기초 학습</a>
        

        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <div class="main-section" data-auto-burger="primary">
         
           <div class="nav-box">
            <h3><a href="/ko/docs/tutorials/hello-minikube/">Get Started</a></h3>
           <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>

            </div>
         
           <div class="nav-box">
            <h3><a href="/ko/docs/home/">문서</a></h3>
           <p>개념, 튜토리얼 및 참조 문서와 함께 쿠버네티스 사용하는 방법을 익힐 수 있다. 또한, <a href="/editdocs/" data-auto-burger-exclude>문서에 기여하는 것도 도움을 줄 수 있다</a>!</p>

            </div>
         
        </div>
        <div class="main-section" data-auto-burger="primary">
            <div class="left">
                <h5 class="github-invite">코어 쿠버네티스 코드 베이스를 살펴보는데 관심이 있으십니까?</h5>
                <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>GitHub에서 보기</a>
            </div>

            <div class="right">
                <h5 class="github-invite">커뮤니티 둘러보기</h5>
                <div class="social">
                    <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                    <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                    <a href="http://slack.k8s.io/" class="slack"><span>Slack Slack</span></a>
                    <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                    <a href="https://www.youtube.com/kubernetescommunity" class="youtube"><span>YouTube</span></a>
                    <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                    <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>이벤트 캘린더</span></a>
                </div>
            </div>
            <div class="clear" style="clear: both"></div>
        </div>
    </nav>
</header>

		
		
		<section id="hero" class="light-text no-sub">
			













<h1>튜토리얼</h1>
<h5></h5>






<div id="vendorStrip" class="light-text">
	<ul>
		
		
		<li><a href="/ko/docs/home/">홈</a></li>
		
		
		<li><a href="/ko/docs/setup/">시작하기</a></li>
		
		
		<li><a href="/ko/docs/concepts/">개념</a></li>
		
		
		<li><a href="/ko/docs/tasks/">태스크</a></li>
		
		
		<li><a href="/ko/docs/tutorials/" class="YAH">튜토리얼</a></li>
		
		
		<li><a href="/ko/docs/reference/">레퍼런스</a></li>
		
		
		<li><a href="/ko/docs/contribute/">기여</a></li>
		
	</ul>
	<form id="searchBox" action="/docs/search/" role="search">
		<input type="text" id="search" name="q" placeholder="검색하기" aria-label="Search">
	</form>
</div>

		</section>
		
    
		
<section id="deprecationWarning">
  <main>
    <div class="content deprecation-warning">
      <h3>
	 Kubernetes v1.17
	  문서는 더 이상 적극적으로 관리되지 않음. 현재 보고있는 문서는 정적 스냅샷임. 최신 문서를 위해서는, 다음을 참고. 
	 <a href="https://kubernetes.io/docs/home/">최신 버전.</a>
      </h3>
    </div>
  </main>
</section>


    <main>
        <section id="encyclopedia">
          
<div id="docsToc">
     <div class="pi-accordion">
    	
        
        
        
        
        
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
             
         
             
                 
                          
                          
                 
             
         
             
         
             
         
         
        
        <a class="item" data-title="튜토리얼" href="/ko/docs/tutorials/"></a>

	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Hello Minikube" href="/ko/docs/tutorials/hello-minikube/"></a>

		
	
		
			
<div class="item" data-title="쿠버네티스 기초 학습">
	<div class="container">
		
		
		
		<a class="item" data-title="쿠버네티스 기초 학습" href="/ko/docs/tutorials/kubernetes-basics/"></a>
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			
<div class="item" data-title="클러스터 생성하기">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Minikube를 사용해서 클러스터 생성하기" href="/ko/docs/tutorials/kubernetes-basics/create-cluster/cluster-intro/"></a>

		
	
		
			

<a class="item" data-title="대화형 튜토리얼 - 클러스터 생성하기" href="/ko/docs/tutorials/kubernetes-basics/create-cluster/cluster-interactive/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="앱 배포하기">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="kubectl을 사용해서 디플로이먼트 생성하기" href="/ko/docs/tutorials/kubernetes-basics/deploy-app/deploy-intro/"></a>

		
	
		
			

<a class="item" data-title="대화형 튜토리얼 - 앱 배포하기" href="/ko/docs/tutorials/kubernetes-basics/deploy-app/deploy-interactive/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="앱 조사하기">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="파드와 노드 보기" href="/ko/docs/tutorials/kubernetes-basics/explore/explore-intro/"></a>

		
	
		
			

<a class="item" data-title="대화형 튜토리얼 - 앱 조사하기" href="/ko/docs/tutorials/kubernetes-basics/explore/explore-interactive/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="앱 외부로 노출하기">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="앱 노출을 위해 서비스 이용하기" href="/ko/docs/tutorials/kubernetes-basics/expose/expose-intro/"></a>

		
	
		
			

<a class="item" data-title="대화형 튜토리얼 - 앱 노출하기" href="/ko/docs/tutorials/kubernetes-basics/expose/expose-interactive/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="앱 스케일링하기">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="복수의 앱 인스턴스를 구동하기" href="/ko/docs/tutorials/kubernetes-basics/scale/scale-intro/"></a>

		
	
		
			

<a class="item" data-title="대화형 튜토리얼 - 앱 스케일링하기" href="/ko/docs/tutorials/kubernetes-basics/scale/scale-interactive/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="앱 업데이트하기">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="롤링 업데이트 수행하기" href="/ko/docs/tutorials/kubernetes-basics/update/update-intro/"></a>

		
	
		
			

<a class="item" data-title="대화형 튜토리얼 - 앱 업데이트 하기" href="/ko/docs/tutorials/kubernetes-basics/update/update-interactive/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="설정">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="컨피그 맵을 사용해서 Redis 설정하기" href="/ko/docs/tutorials/configuration/configure-redis-using-configmap/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="상태 유지를 하지 않는 애플리케이션">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="외부 IP 주소를 노출하여 클러스터의 애플리케이션에 접속하기" href="/ko/docs/tutorials/stateless-application/expose-external-ip-address/"></a>

		
	
		
			

<a class="item" data-title="예시: Redis를 사용한 PHP 방명록 애플리케이션 배포하기" href="/ko/docs/tutorials/stateless-application/guestbook/"></a>

		
	
		
			

<a class="item" data-title="예제: PHP / Redis 방명록 예제에 로깅과 메트릭 추가" href="/ko/docs/tutorials/stateless-application/guestbook-logs-metrics-with-elk/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="상태 유지가 필요한(stateful) 애플리케이션">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="스테이트풀셋 기본" href="/ko/docs/tutorials/stateful-application/basic-stateful-set/"></a>

		
	
		
			

<a class="item" data-title="예시: WordPress와 MySQL을 퍼시스턴트 볼륨에 배포하기" href="/ko/docs/tutorials/stateful-application/mysql-wordpress-persistent-volume/"></a>

		
	
		
			

<a class="item" data-title="예시: 카산드라를 스테이트풀셋으로 배포하기" href="/ko/docs/tutorials/stateful-application/cassandra/"></a>

		
	
		
			

<a class="item" data-title="분산 시스템 코디네이터 ZooKeeper 실행하기" href="/ko/docs/tutorials/stateful-application/zookeeper/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="클러스터">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="AppArmor" href="/ko/docs/tutorials/clusters/apparmor/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="서비스">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="소스 IP 주소 이용하기" href="/ko/docs/tutorials/services/source-ip/"></a>

		
	

	</div>
</div>

		
	





     </div> 
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 


          <div id="docsContent">
            

<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/ko/docs/tutorials/clusters/apparmor.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>

<h1>AppArmor</h1>



<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.4</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>beta</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="beta">
이 기능은 현재 <em>베타(beta)</em> 상태로, 다음을 의미한다.</p>

<ul>
<li>버전 이름에는 베타(예: v2beta3)가 포함된다.</li>
<li>코드의 테스트가 완료되었다. 기능을 활성화해도 안전한 것으로 간주한다. 기본으로 활성화되어 있다.</li>
<li>자세한 내용은 변경될 수 있지만, 전체 기능에 대한 지원은 중단되지 않는다.</li>
<li>오브젝트의 스키마 및(또는) 의미(semantics)는 후속 베타 또는 안정적인 릴리즈에서 호환되지 않는 방식으로 변경될 수 있다. 이 경우, 다음 버전으로 마이그레이션하기 위한 지침을 제공할 것이다. 이를 위해서는 API 오브젝트의 삭제, 수정 또는 재생성이 필요할 수 있다. 편집 과정에서 약간의 생각이 필요할 수 있다. 이 기능을 사용하는 애플리케이션은 가동 중지 시간(downtime)이 필요할 수 있다.</li>
<li>후속 릴리즈에서 호환되지 않는 변경 가능성이 있으므로 오직 업무상 중요하지 않은 용도로만 권장한다. 만약 사용자가 독립적으로 업그레이드가 가능한 다중 클러스터를 가지고 있다면, 이 제약은 완화될 수 있다.</li>
<li><strong>베타 기능을 사용해보고, 우리에게 피드백을 주십시오! 베타가 종료된 후에 많은 것을 변경하는 것은 타당하지 않을 수 있습니다.</strong></li>
</ul>
</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>AppArmor는 표준 리눅스 사용자와 그룹 기반의 권한을 보완하여, 한정된 리소스 집합으로
프로그램을 제한하는 리눅스 커널 보안 모듈이다. AppArmor는 임의의 애플리케이션에 대해서
잠재적인 공격 범위를 줄이고 더욱 심층적인 방어를 제공하도록 구성할 수 있다.
이 기능은 특정 프로그램이나 컨테이너에서 필요한 리눅스 기능, 네트워크 사용, 파일 권한 등에 대한
접근 허용 목록 조정한 프로파일로 구성한다. 각 프로파일은
허용하지 않은 리소스 접근을 차단하는 <em>강제(enforcing)</em> 모드 또는
위반만을 보고하는 <em>불평(complain)</em> 모드로 실행할 수 있다.</p>

<p>AppArmor를 이용하면 컨테이너가 수행할 수 있는 작업을 제한하고 또는
시스템 로그를 통해 더 나은 감사를 제공하여 더 안전한 배포를 실행할 수 있다.
그러나 AppArmor가 은탄환(언제나 통하는 무적의 방법)이 아니며,
애플리케이션 코드 취약점을 보호하기 위한 여러 조치를 할 수 있는 것 뿐임을 잊으면 안된다.
양호하고 제한적인 프로파일을 제공하고, 애플리케이션과 클러스터를 여러 측면에서 강화하는 것이 중요하다.</p>












<ul id="markdown-toc">










<li><a href="#%eb%aa%a9%ec%a0%81">목적</a></li>












<li><a href="#%ec%8b%9c%ec%9e%91%ed%95%98%ea%b8%b0-%ec%a0%84%ec%97%90">시작하기 전에</a></li>












<li><a href="#securing-a-pod">파드 보안 강화하기</a></li>




<li><a href="#example">예시</a></li>




<li><a href="#administration">관리</a></li>




<li><a href="#authoring-profiles">프로파일 제작</a></li>




<li><a href="#api-reference">API 참조</a></li>




























<li><a href="#%eb%8b%a4%ec%9d%8c-%eb%82%b4%ec%9a%a9">다음 내용</a></li>



</ul>



<h2 id="목적">목적</h2>
<ul>
<li>노드에 프로파일을 어떻게 적재하는지 예시를 본다.</li>
<li>파드(Pod)에 프로파일을 어떻게 강제 적용하는지 배운다.</li>
<li>프로파일이 적재되었는지 확인하는 방법을 배운다.</li>
<li>프로파일을 위반하는 경우를 살펴본다.</li>
<li>프로파일을 적재할 수 없을 경우를 살펴본다.</li>
</ul>





<h2 id="시작하기-전에">시작하기 전에</h2>
<p>다음을 보장해야 한다.</p>

<ol>
<li><p>쿠버네티스 버전은 최소 1.4 이다. &ndash; 쿠버네티스 v1.4부터 AppArmor 지원을 추가했다.
v1.4 이전 쿠버네티스 컴포넌트는 새로운 AppArmor 어노테이션을 인식하지 못하고
제공되는 AppArmor 설정을 <strong>조용히 무시</strong>할 것이다. 파드에서 예상하는 보호를 받고 있는지 확인하려면
해당 노드의 Kubelet 버전을 확인하는 것이 중요하다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl get nodes -o<span style="color:#666">=</span><span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">$&#39;{range .items[*]}{@.metadata.name}: {@.status.nodeInfo.kubeletVersion}\n{end}&#39;</span></code></pre></div>
<pre><code>gke-test-default-pool-239f5d02-gyn2: v1.4.0
gke-test-default-pool-239f5d02-x1kf: v1.4.0
gke-test-default-pool-239f5d02-xwux: v1.4.0
</code></pre></li>

<li><p>AppArmor 커널 모듈을 사용 가능해야 한다. &ndash; 리눅스 커널에 AppArmor 프로파일을 강제 적용하기 위해 AppArmor 커널 모듈은 반드시 설치되어 있고
사용 가능해야 한다. 예를 들어 Ubuntu 및 SUSE 같은 배포판은 모듈을 기본값으로 지원하고, 그 외 많은 다른 배포판들은 선택적으로 지원한다.
모듈이 사용 가능한지 확인하려면
<code>/sys/module/apparmor/parameters/enabled</code> 파일을 확인한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ cat /sys/module/apparmor/parameters/enabled
Y</code></pre></div></li>
</ol>

<p>Kubelet(&gt;=v1.4)이 AppArmor 기능 지원을 포함하지만, 커널 모듈을 사용할 수 없으면
   파드에서 AppArmor 옵션을 실행하는 것이 거부된다.</p>

<p><blockquote class="note">
  <div><strong>참고:</strong> 우분투에는 추가적인 훅(hook)이나 추가 기능 패치를 포함한 리눅스 커널의 상위 스트림에 머지되지 않은
  많은 AppArmor 패치를 가지고 있다. 쿠버네티스는
  상위 스트림 버전에서 테스트한 패치만을 가지고 있어서 다른 기능은 지원을 보장하지 않는다.</div>
</blockquote></p>

<ol>
<li><p>컨테이너 런타임이 AppArmor을 지원한다. &ndash; 현재 모든 일반적인 쿠버네티스를 지원하는
<a class='glossary-tooltip' href='https://docs.docker.com/engine/' target='_blank'>도커(Docker)<span class='tooltip-text'>Docker는 운영 시스템 수준의 가상화를 제공하는 소프트웨어 기술이며, 컨테이너로도 알려져 있다.</span>
</a>, <a class='glossary-tooltip' href='https://cri-o.io/#what-is-cri-o' target='_blank'>CRI-O<span class='tooltip-text'>A lightweight container runtime specifically for Kubernetes</span>
</a> 또는
<a class='glossary-tooltip' href='https://containerd.io/docs/' target='_blank'>containerd<span class='tooltip-text'>A container runtime with an emphasis on simplicity, robustness and portability</span>
</a> 와 같은 컨테이너 런타임들은 AppArmor를 지원해야 한다.
이 런타임 설명서를 참조해서 클러스터가 AppArmor를 사용하기 위한
요구 사항을 충족하는지 확인해야 한다.</p></li>

<li><p>프로파일이 적재되어 있다. &ndash; AppArmor는 각 컨테이너와 함께 실행해야 하는 AppArmor 프로파일을 지정하여 파드에 적용한다.
커널에 지정한 프로파일이 적재되지 않았다면, Kubelet(&gt;= v1.4)은 파드를 거부한다. 해당 노드에 어떤 프로파일이 적재되었는지는
<code>/sys/kernel/security/apparmor/profiles</code> 파일을 통해 확인할 수 있다.
예를 들어,</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ ssh gke-test-default-pool-239f5d02-gyn2 <span style="color:#b44">&#34;sudo cat /sys/kernel/security/apparmor/profiles | sort&#34;</span></code></pre></div>
<pre><code>apparmor-test-deny-write (enforce)
apparmor-test-audit-write (enforce)
docker-default (enforce)
k8s-nginx (enforce)
</code></pre></li>
</ol>

<p>노드에 프로파일을 적재하는 것에 대해 더 자세한 내용은
   <a href="#setting-up-nodes-with-profiles">프로파일과 함께 노드 설정하기</a>.</p>

<p>AppArmor 지원이 포함된 Kubelet (&gt;= v1.4)이면
어떤 전제 조건이 충족되지 않으면 AppArmor와 함께한 파드를 거부한다.
노드 상에 AppArmor 지원 여부는
노드 준비 조건 메시지를 확인하여(이후 릴리즈에서는 삭제될 것 같지만) 검증할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl get nodes -o<span style="color:#666">=</span><span style="color:#b8860b">jsonpath</span><span style="color:#666">=</span><span style="color:#b44">$&#39;{range .items[*]}{@.metadata.name}: {.status.conditions[?(@.reason==&#34;KubeletReady&#34;)].message}\n{end}&#39;</span></code></pre></div>
<pre><code>gke-test-default-pool-239f5d02-gyn2: kubelet is posting ready status. AppArmor enabled
gke-test-default-pool-239f5d02-x1kf: kubelet is posting ready status. AppArmor enabled
gke-test-default-pool-239f5d02-xwux: kubelet is posting ready status. AppArmor enabled
</code></pre>




<h2 id="securing-a-pod">파드 보안 강화하기</h2>

<blockquote class="note">
  <div><strong>참고:</strong> AppArmor는 현재 베타라서 옵션은 어노테이션 형식으로 지정한다. 일반 사용자 버전이 되면,
어노테이션은 최상위 종류의 필드로 대체될 것이다(자세한 내용은
<a href="#upgrade-path-to-general-availability">일반 사용자 버전으로 업그레이드 방법</a> 참고)</div>
</blockquote>

<p>AppArmor 프로파일은 <em>컨테이너마다</em> 지정된다. 함께 실행할 파드 컨테이너에 AppArmor 프로파일을 지정하려면
파드의 메타데이터에 어노테이션을 추가한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">container.apparmor.security.beta.kubernetes.io/&lt;container_name&gt;:<span style="color:#bbb"> </span>&lt;profile_ref&gt;</code></pre></div>
<p><code>&lt;container_name&gt;</code>은 프로파일을 적용하는 컨테이너 이름이고, <code>&lt;profile_ref&gt;</code>는
적용할 프로파일을 지정한다. <code>profile_ref</code>는 다음 중에 하나이다.</p>

<ul>
<li>런타임의 기본 프로파일을 적용하기 위한 <code>runtime/default</code></li>
<li><code>&lt;profile_name&gt;</code>로 이름한 호스트에 적재되는 프로파일을 적용하기 위한 <code>localhost/&lt;profile_name&gt;</code></li>
<li>적재할 프로파일이 없음을 나타내는  <code>unconfined</code></li>
</ul>

<p>어노테이션과 프로파일 이름 형식의 자세한 내용은 <a href="#api-reference">API 참조</a>를 살펴본다.</p>

<p>쿠버네티스 AppArmor 의 작동 순서는 모든 선행 조건이 충족되었는지 확인하고,
적용을 위해 선택한 프로파일을 컨테이너 런타임으로 전달하여 이루어진다.
만약 선행 조건이 충족되지 않으면 파드는 거부되고 실행되지 않는다.</p>

<p>프로파일이 적용되었는지 확인하기 위해, 컨테이너 생성 이벤트에 나열된 AppArmor 보안 옵션을 찾아 볼 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl get events | grep Created</code></pre></div>
<pre><code>22s        22s         1         hello-apparmor     Pod       spec.containers{hello}   Normal    Created     {kubelet e2e-test-stclair-node-pool-31nt}   Created container with docker id 269a53b202d3; Security:[seccomp=unconfined apparmor=k8s-apparmor-example-deny-write]apparmor=k8s-apparmor-example-deny-write]
</code></pre>

<p>컨테이너의 루트 프로세스가 올바른 프로파일로 실행되는지는 proc attr을 확인하여 직접 검증할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl <span style="color:#a2f">exec</span> &lt;pod_name&gt; cat /proc/1/attr/current</code></pre></div>
<pre><code>k8s-apparmor-example-deny-write (enforce)
</code></pre>

<h2 id="example">예시</h2>

<p><em>이 예시는 AppArmor를 지원하는 클러스터를 이미 구성하였다고 가정한다.</em></p>

<p>먼저 노드에서 사용하려는 프로파일을 적재해야 한다. 사용할 프로파일은 단순히
파일 쓰기를 거부할 것이다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#080;font-style:italic">#include &lt;tunables/global&gt;</span>

profile k8s-apparmor-example-deny-write <span style="color:#b8860b">flags</span><span style="color:#666">=(</span>attach_disconnected<span style="color:#666">)</span> <span style="color:#666">{</span>
  <span style="color:#080;font-style:italic">#include &lt;abstractions/base&gt;</span>

  file,

  <span style="color:#080;font-style:italic"># Deny all file writes.</span>
  deny /** w,
<span style="color:#666">}</span></code></pre></div>
<p>파드를 언제 스케줄할지 알지 못하므로 모든 노드에 프로파일을 적재해야 한다.
이 예시에서는 SSH를 이용하여 프로파일을 설치할 것이나 다른 방법은
<a href="#setting-up-nodes-with-profiles">프로파일과 함께 노드 설정하기</a>에서 논의한다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#b8860b">NODES</span><span style="color:#666">=(</span>
    <span style="color:#080;font-style:italic"># The SSH-accessible domain names of your nodes</span>
    gke-test-default-pool-239f5d02-gyn2.us-central1-a.my-k8s
    gke-test-default-pool-239f5d02-x1kf.us-central1-a.my-k8s
    gke-test-default-pool-239f5d02-xwux.us-central1-a.my-k8s<span style="color:#666">)</span>
<span style="color:#a2f;font-weight:bold">for</span> NODE in <span style="color:#b68;font-weight:bold">${</span><span style="color:#b8860b">NODES</span>[*]<span style="color:#b68;font-weight:bold">}</span>; <span style="color:#a2f;font-weight:bold">do</span> ssh <span style="color:#b8860b">$NODE</span> <span style="color:#b44">&#39;sudo apparmor_parser -q &lt;&lt;EOF
</span><span style="color:#b44">#include &lt;tunables/global&gt;
</span><span style="color:#b44">
</span><span style="color:#b44">profile k8s-apparmor-example-deny-write flags=(attach_disconnected) {
</span><span style="color:#b44">  #include &lt;abstractions/base&gt;
</span><span style="color:#b44">
</span><span style="color:#b44">  file,
</span><span style="color:#b44">
</span><span style="color:#b44">  # Deny all file writes.
</span><span style="color:#b44">  deny /** w,
</span><span style="color:#b44">}
</span><span style="color:#b44">EOF&#39;</span>
<span style="color:#a2f;font-weight:bold">done</span></code></pre></div>
<p>다음으로 쓰기 금지 프로파일된 &ldquo;Hello AppArmor&rdquo; 파드를 실행한다.</p>

<table class="includecode" id="pods-security-hello-apparmor-yaml">
    <thead>
        <tr>
            <th>
                <a href="https://raw.githubusercontent.com/kubernetes/website/master/content/ko/examples/pods/security/hello-apparmor.yaml" download="pods/security/hello-apparmor.yaml">
                    <code>pods/security/hello-apparmor.yaml</code>
                </a>
                <img src="/images/copycode.svg" style="max-height:24px; cursor: pointer" onclick="copyCode('pods-security-hello-apparmor-yaml')" title="Copy pods/security/hello-apparmor.yaml to clipboard">
            </th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>hello-apparmor<span style="color:#bbb">
</span><span style="color:#bbb">  </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># 쿠버네티스에 &#39;k8s-apparmor-example-deny-write&#39; AppArmor 프로파일을 적용함을 알린다.</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#080;font-style:italic"># 잊지 말 것은 쿠버네티스 노드에서 실행 중인 버전이 1.4 이상이 아닌 경우에는 이 설정은 무시된다는 것이다.</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>container.apparmor.security.beta.kubernetes.io/hello:<span style="color:#bbb"> </span>localhost/k8s-apparmor-example-deny-write<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>hello<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>busybox<span style="color:#bbb">
</span><span style="color:#bbb">    </span>command:<span style="color:#bbb"> </span>[<span style="color:#bbb"> </span><span style="color:#b44">&#34;sh&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;-c&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;echo &#39;Hello AppArmor!&#39; &amp;&amp; sleep 1h&#34;</span><span style="color:#bbb"> </span>]</code></pre></div>  </td>
        </tr>
    </tbody>
</table>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create -f ./hello-apparmor.yaml</code></pre></div>
<p>파드 이벤트를 살펴보면, &lsquo;k8s-apparmor-example-deny-write&rsquo; AppArmor 프로파일로 생성된 파드 컨테이너를
확인할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl get events | grep hello-apparmor</code></pre></div>
<pre><code>14s        14s         1         hello-apparmor   Pod                                Normal    Scheduled   {default-scheduler }                           Successfully assigned hello-apparmor to gke-test-default-pool-239f5d02-gyn2
14s        14s         1         hello-apparmor   Pod       spec.containers{hello}   Normal    Pulling     {kubelet gke-test-default-pool-239f5d02-gyn2}   pulling image &quot;busybox&quot;
13s        13s         1         hello-apparmor   Pod       spec.containers{hello}   Normal    Pulled      {kubelet gke-test-default-pool-239f5d02-gyn2}   Successfully pulled image &quot;busybox&quot;
13s        13s         1         hello-apparmor   Pod       spec.containers{hello}   Normal    Created     {kubelet gke-test-default-pool-239f5d02-gyn2}   Created container with docker id 06b6cd1c0989; Security:[seccomp=unconfined apparmor=k8s-apparmor-example-deny-write]
13s        13s         1         hello-apparmor   Pod       spec.containers{hello}   Normal    Started     {kubelet gke-test-default-pool-239f5d02-gyn2}   Started container with docker id 06b6cd1c0989
</code></pre>

<p>proc attr을 확인하여 컨테이너가 실제로 해당 프로파일로 실행 중인지 확인할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl <span style="color:#a2f">exec</span> hello-apparmor cat /proc/1/attr/current</code></pre></div>
<pre><code>k8s-apparmor-example-deny-write (enforce)
</code></pre>

<p>마지막으로 파일 쓰기를 통해 프로파일을 위반하면 어떻게 되는지 확인할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl <span style="color:#a2f">exec</span> hello-apparmor touch /tmp/test</code></pre></div>
<pre><code>touch: /tmp/test: Permission denied
error: error executing remote command: command terminated with non-zero exit code: Error executing in Docker Container: 1
</code></pre>

<p>이제 정리하면서, 적재되지 않은 프로파일을 지정하면 어떻게 되는지 살펴본다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create -f /dev/stdin &lt;&lt;EOF</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>hello-apparmor<span style="color:#666">-2</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>container.apparmor.security.beta.kubernetes.io/hello:<span style="color:#bbb"> </span>localhost/k8s-apparmor-example-allow-write<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>hello<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>busybox<span style="color:#bbb">
</span><span style="color:#bbb">    </span>command:<span style="color:#bbb"> </span>[<span style="color:#bbb"> </span><span style="color:#b44">&#34;sh&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;-c&#34;</span>,<span style="color:#bbb"> </span><span style="color:#b44">&#34;echo &#39;Hello AppArmor!&#39; &amp;&amp; sleep 1h&#34;</span><span style="color:#bbb"> </span>]<span style="color:#bbb">
</span><span style="color:#bbb"></span>EOF<span style="color:#bbb">
</span><span style="color:#bbb"></span>pod/hello-apparmor<span style="color:#666">-2</span><span style="color:#bbb"> </span>created</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl describe pod hello-apparmor-2</code></pre></div>
<pre><code>Name:          hello-apparmor-2
Namespace:     default
Node:          gke-test-default-pool-239f5d02-x1kf/
Start Time:    Tue, 30 Aug 2016 17:58:56 -0700
Labels:        &lt;none&gt;
Annotations:   container.apparmor.security.beta.kubernetes.io/hello=localhost/k8s-apparmor-example-allow-write
Status:        Pending
Reason:        AppArmor
Message:       Pod Cannot enforce AppArmor: profile &quot;k8s-apparmor-example-allow-write&quot; is not loaded
IP:
Controllers:   &lt;none&gt;
Containers:
  hello:
    Container ID:
    Image:     busybox
    Image ID:
    Port:
    Command:
      sh
      -c
      echo 'Hello AppArmor!' &amp;&amp; sleep 1h
    State:              Waiting
      Reason:           Blocked
    Ready:              False
    Restart Count:      0
    Environment:        &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-dnz7v (ro)
Conditions:
  Type          Status
  Initialized   True
  Ready         False
  PodScheduled  True
Volumes:
  default-token-dnz7v:
    Type:    Secret (a volume populated by a Secret)
    SecretName:    default-token-dnz7v
    Optional:   false
QoS Class:      BestEffort
Node-Selectors: &lt;none&gt;
Tolerations:    &lt;none&gt;
Events:
  FirstSeen    LastSeen    Count    From                        SubobjectPath    Type        Reason        Message
  ---------    --------    -----    ----                        -------------    --------    ------        -------
  23s          23s         1        {default-scheduler }                         Normal      Scheduled     Successfully assigned hello-apparmor-2 to e2e-test-stclair-minion-group-t1f5
  23s          23s         1        {kubelet e2e-test-stclair-node-pool-t1f5}             Warning        AppArmor    Cannot enforce AppArmor: profile &quot;k8s-apparmor-example-allow-write&quot; is not loaded
</code></pre>

<p>파드 상태는 Failed이며 오류메시지는 <code>Pod Cannot enforce AppArmor: profile
&quot;k8s-apparmor-example-allow-write&quot; is not loaded</code>이다. 이벤트도 동일한 메시지로 기록되었다.</p>

<h2 id="administration">관리</h2>

<h3 id="setting-up-nodes-with-profiles">프로파일과 함께 노드 설정하기</h3>

<p>현재 쿠버네티스는 AppArmor 프로파일을 노드에 적재하기 위한 네이티브 메커니즘을 제공하지 않는다.
프로파일을 설정하는 여러 방법이 있다. 예를 들면 다음과 같다.</p>

<ul>
<li>각 노드에서 파드를 실행하는 <a href="/ko/docs/concepts/workloads/controllers/daemonset/">데몬셋</a>을 통해서
올바른 프로파일이 적재되었는지 확인한다. 예시 구현은
<a href="https://git.k8s.io/kubernetes/test/images/apparmor-loader" target="_blank">여기</a>에서 찾아볼 수 있다.</li>
<li>노드 초기화 시간에 노드 초기화 스크립트(예를 들어 Salt, Ansible 등)나
이미지를 이용</li>
<li><a href="#example">예시</a>에서 보여준 것처럼,
프로파일을 각 노드에 복사하고 SSH를 통해 적재한다.</li>
</ul>

<p>스케줄러는 어떤 프로파일이 어떤 노드에 적재되는지 고려하지 않으니, 프로파일 전체 집합이
모든 노드에 적재되어야 한다. 대안적인 방법은
각 프로파일(혹은 프로파일의 클래스)을 위한 노드 레이블을 노드에 추가하고,
<a href="/ko/docs/concepts/configuration/assign-pod-node/">노드 셀렉터</a>를 이용하여
파드가 필요한 프로파일이 있는 노드에서 실행되도록 한다.</p>

<h3 id="restricting-profiles-with-the-podsecuritypolicy">PodSecurityPolicy로 프로파일 제한하기</h3>

<p>만약 PodSecurityPolicy 확장을 사용하면, 클러스터 단위로 AppArmor 제한을 적용할 수 있다.
PodSecurityPolicy를 사용하려면 위해 다음의 플래그를 반드시 <code>apiserver</code>에 설정해야 한다.</p>

<pre><code>--enable-admission-plugins=PodSecurityPolicy[,others...]
</code></pre>

<p>AppArmor 옵션은 PodSecurityPolicy의 어노테이션으로 지정할 수 있다.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apparmor.security.beta.kubernetes.io/defaultProfileName:<span style="color:#bbb"> </span>&lt;profile_ref&gt;<span style="color:#bbb">
</span><span style="color:#bbb"></span>apparmor.security.beta.kubernetes.io/allowedProfileNames:<span style="color:#bbb"> </span>&lt;profile_ref&gt;[,others...]</code></pre></div>
<p>기본 프로파일 이름 옵션은 프로파일을 지정하지 않았을 때에
컨테이너에 기본으로 적용하는 프로파일을 지정한다.
허용하는 프로파일 이름 옵션은 파드 컨테이너가 함께 실행하도록 허용되는 프로파일 목록을 지정한다.
두 옵션을 모두 사용하는 경우, 기본값은 반드시 필요하다.
프로파일은 컨테이너에서 같은 형식으로 지정된다. 전체 사양은 <a href="#api-reference">API 참조</a>를 찾아본다.</p>

<h3 id="disabling-apparmor">AppArmor 비활성화</h3>

<p>클러스터에서 AppArmor 사용하지 않으려면, 커맨드라인 플래그로 비활성화 할 수 있다.</p>

<pre><code>--feature-gates=AppArmor=false
</code></pre>

<p>비활성화되면 AppArmor 프로파일을 포함한 파드는 &ldquo;Forbidden&rdquo; 오류로 검증 실패한다.
기본적으로 도커는 항상 비특권 파드에 &ldquo;docker-default&rdquo; 프로파일을 활성화하고(AppArmor 커널모듈이 활성화되었다면),
기능 게이트가 비활성화된 것처럼 진행한다.
AppArmor를 비활성화하는 이 옵션은
AppArmor가 일반 사용자 버전이 되면 제거된다.</p>

<h3 id="upgrading-to-kubernetes-v1.4-with-apparmor">AppArmor와 함께 쿠버네티스 1.4로 업그레이드 하기</h3>

<p>클러스터 버전을 v1.4로 업그레이드하기 위해 AppArmor쪽 작업은 없다.
그러나 AppArmor 어노테이션을 가진 파드는 유효성 검사(혹은 PodSecurityPolicy 승인)을 거치지 않는다.
그 노드에 허용 프로파일이 로드되면, 악의적인 사용자가 허가 프로필을 미리 적용하여
파드의 권한을 docker-default 보다 높일 수 있다.
이것이 염려된다면 <code>apparmor.security.beta.kubernetes.io</code> 어노테이션이 포함된
모든 파드의 클러스터를 제거하는 것이 좋다.</p>

<h3 id="upgrade-path-to-general-availability">일반 사용자 버전으로 업그레이드 방법</h3>

<p>AppArmor는 일반 사용자 버전(general available)으로 준비되면 현재 어노테이션으로 지정되는 옵션은 필드로 변경될 것이다.
모든 업그레이드와 다운그레이드 방법은 전환을 통해 지원하기에는 매우 미묘하니
전환이 필요할 때에 상세히 설명할 것이다.
최소 두 번의 릴리즈에 대해서는 필드와 어노테이션 모두를 지원할 것이고,
그 이후부터는 어노테이션은 명확히 거부된다.</p>

<h2 id="authoring-profiles">프로파일 제작</h2>

<p>AppArmor 프로파일을 만들고 올바르게 지정하는 것은 매우 까다로울 수 있다.
다행히 이 작업에 도움 되는 도구가 있다.</p>

<ul>
<li><code>aa-genprof</code>와 <code>aa-logprof</code>는 애플리케이션 활동과 로그와 수행에 필요한 행동을 모니터링하여
일반 프로파일 규칙을 생성한다. 자세한 사용방법은
<a href="https://gitlab.com/apparmor/apparmor/wikis/Profiling_with_tools" target="_blank">AppArmor 문서</a>에서 제공한다.</li>
<li><a href="https://github.com/jfrazelle/bane" target="_blank">bane</a>은 단순화된 프로파일 언어를 이용하는 도커를 위한
AppArmor 프로파일 생성기이다.</li>
</ul>

<p>개발 장비의 도커를 통해 애플리케이션을 실행하여
프로파일을 생성하는 것을 권장하지만,
파드가 실행 중인 쿠버네티스 노드에서 도구 실행을 금하지는 않는다.</p>

<p>AppArmor 문제를 디버깅하기 위해서 거부된 것으로 보이는 시스템 로그를 확인할 수 있다.
AppArmor 로그는 <code>dmesg</code>에서 보이며, 오류는 보통 시스템 로그나
<code>journalctl</code>에서 볼 수 있다. 더 많은 정보는
<a href="https://gitlab.com/apparmor/apparmor/wikis/AppArmor_Failures" target="_blank">AppArmor 실패</a>에서 제공한다.</p>

<h2 id="api-reference">API 참조</h2>

<h3 id="pod-annotation">파드 어노테이션</h3>

<p>컨테이너를 실행할 프로파일을 지정한다.</p>

<ul>
<li><strong>키</strong>: <code>container.apparmor.security.beta.kubernetes.io/&lt;container_name&gt;</code>
<code>&lt;container_name&gt;</code>는 파드 내에 컨테이너 이름과 일치한다.
분리된 프로파일은 파드 내에 각 컨테이너로 지정할 수 있다.</li>
<li><strong>값</strong>: 아래 기술된 프로파일 참조</li>
</ul>

<h3 id="profile-reference">프로파일 참조</h3>

<ul>
<li><code>runtime/default</code>: 기본 런타임 프로파일을 참조한다.

<ul>
<li>(기본 PodSecurityPolicy 없이) 프로파일을 지정하지 않고
AppArmor를 사용하는 것과 동등하다.</li>
<li>도커에서는 권한 없는 컨테이너의 경우는
<a href="https://docs.docker.com/engine/security/apparmor/" target="_blank"><code>docker-default</code></a> 프로파일로,
권한이 있는 컨테이너의 경우 unconfined(프로파일 없음)으로 해석한다.</li>
</ul></li>
<li><code>localhost/&lt;profile_name&gt;</code>: 노드(localhost)에 적재된 프로파일을 이름으로 참조한다.

<ul>
<li>가용한 프로파일 이름의 상세 내용은
<a href="https://gitlab.com/apparmor/apparmor/wikis/AppArmor_Core_Policy_Reference#profile-names-and-attachment-specifications" target="_blank">핵심 정책 참조</a>에 설명되어 있다.</li>
</ul></li>
<li><code>unconfined</code>: 이것은 컨테이너에서 AppArmor를 효과적으로 비활성시킨다.</li>
</ul>

<p>다른 어떤 프로파일 참조 형식도 유효하지 않다.</p>

<h3 id="podsecuritypolicy-annotations">PodSecurityPolicy 어노테이션</h3>

<p>아무 프로파일도 제공하지 않을 때에 컨테이너에 적용할 기본 프로파일을 지정하기</p>

<ul>
<li><strong>키</strong>: <code>apparmor.security.beta.kubernetes.io/defaultProfileName</code></li>
<li><strong>값</strong>: 프로파일 참조. 위에 기술됨.</li>
</ul>

<p>파드 컨테이너에서 지정을 허용하는 프로파일 목록 지정하기</p>

<ul>
<li><strong>키</strong>: <code>apparmor.security.beta.kubernetes.io/allowedProfileNames</code></li>
<li><strong>값</strong>: 컴마로 구분된 참조 프로파일 목록(위에 기술함)

<ul>
<li>비록 이스케이프된 쉼표(%2C &lsquo;,&rsquo;)도 프로파일 이름에서 유효한 문자이지만
여기에서 명시적으로 허용하지 않는다.</li>
</ul></li>
</ul>



















<h2 id="다음-내용">다음 내용</h2>
<p>참고 자료</p>

<ul>
<li><a href="https://gitlab.com/apparmor/apparmor/wikis/QuickProfileLanguage" target="_blank">퀵 가이드 AppArmor 프로파일 언어</a></li>
<li><a href="https://gitlab.com/apparmor/apparmor/wikis/Policy_Layout" target="_blank">AppArmor 코어 정책 참고</a></li>
</ul>








    
            
  <h2>피드백</h2>
  <p class="feedback--prompt">이 페이지가 도움이 되었나요? </p>
  <button class="button feedback--yes">네</button>
  <button class="button feedback--no">아니요</button>
  <p class="feedback--response feedback--response__hidden">
    피드백 감사합니다. 쿠버네티스 사용 방법에 대해서 구체적이고 답변 가능한 질문이 있다면, 다음 링크에서 질문하십시오.
    <a target="_blank" rel="noopener"
      href="https://stackoverflow.com/questions/tagged/kubernetes">
      Stack Overflow</a>.
    원한다면 GitHub 리포지터리에 이슈를 열어서
    <a class="feedback--link" target="_blank" rel="noopener"
      href="https://github.com/kubernetes/website/issues/new?title=Issue%20with%20k8s.io">
      문제 리포트</a>
    또는
    <a class="feedback--link" target="_blank" rel="noopener"
      href="https://github.com/kubernetes/website/issues/new?title=Improvement%20for%20k8s.io">
      개선 제안이 가능합니다.</a>.
  </p>
  <script>
    const yes = document.querySelector('.feedback--yes');
    const no = document.querySelector('.feedback--no');
    document.querySelectorAll('.feedback--link').forEach(link => {
      link.href = link.href + window.location.pathname;
    });
    const sendFeedback = (value) => {
      if (!gtag) { console.log('!gtag'); }
      gtag('event', 'click', {
        'event_category': 'Helpful',
        'event_label': window.location.pathname,
        value
      });
    };
    const disableButtons = () => {
      yes.disabled = true;
      yes.classList.add('feedback--button__disabled');
      no.disabled = true;
      no.classList.add('feedback--button__disabled');
    };
    yes.addEventListener('click', () => {
      sendFeedback(1);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
    no.addEventListener('click', () => {
      sendFeedback(0);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
  </script>


    
            <div id="pre-footer"> 
  <hr />

  <div class="issue-button-container">
    <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/tutorials/clusters/apparmor.md?pixel" alt="Analytics" /></a></p>
    
    
    <script type="text/javascript">
    PDRTJS_settings_8345992 = {
    "id" : "8345992",
    "unique_id" : "\/ko\/docs\/tutorials\/clusters\/apparmor\/",
    "title" : "AppArmor",
    "permalink" : "https:\/\/kubernetes.io\/ko\/docs\/tutorials\/clusters\/apparmor\/"
    };
    (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
    </script>
    <a href="" onclick="window.open('https://github.com/kubernetes/website/issues/new?template=bug-report.md&title=Issue%20with%20' +
    'k8s.io'+window.location.pathname)" class="button issue">이슈 생성하기</a>
    
    
    
    <a href="https://github.com/kubernetes/website/edit/master/content/ko/docs/tutorials/clusters/apparmor.md" class="button issue">페이지 편집하기</a>
    
  </div>
  

  <div id="lastedit" class="lastedit issue-button-container">
    최종 수정일시 February 28, 2020 at 11:56 AM PST , 다음 변경에 의해서:
    <a href="https://github.com/kubernetes/website/commit/f9a9884c0cba16b99f7a09701341976f044ff753/">Fifth Korean l10n work for release 1.17 (#19335)</a> (<a href="https://github.com/kubernetes/website/commits/master/content/en/docs/tutorials/clusters/apparmor.md">페이지 변경 이력</a>)
  </div>
  
</div>

          </div>
        </section>
    </main>
		<footer>
    <div class="light-text main-section">
        <nav>
            
            
            
            <a href="/ko/docs/home/">홈</a>
            
            
            
            <a href="/ko/training/">교육</a>
            
            
            
            
            
            <a href="/ko/case-studies/">사례 연구</a>
            
        </nav>
        <div class="social" role="region" aria-label="Social hyperlinks">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="https://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://www.youtube.com/kubernetescommunity" class="youtube"><span>YouTube</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>이벤트 캘린더</span></a>
            </div>
            <div>
                
                <a href="https://git.k8s.io/community/contributors/guide" class="button">기여하기</a>
            </div>
        </div>
        <div class="miceType center">
            &copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a></a>
        </div>
        <div class="miceType center">
            Copyright &copy; 2023 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
        <div class="miceType center">
            ICP license: 京ICP备17074266号-3
        </div>
    </div>
</footer>

		<button class="flyout-button" onclick="kub.toggleToc()" aria-label="Toggle table of contents visibility"></button>

<script>

(function () {
    window.addEventListener('DOMContentLoaded', init)

        
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>



    <script language="application/javascript">
      
      (function addHeadingLinks(){
        var article = document.getElementById('docsContent');
        var headings = article.querySelectorAll('h1, h2, h3, h4, h5, h6');
        headings.forEach(function(heading){
          if(heading.id){
            var a = document.createElement('a');
            a.innerHTML = heading.innerHTML;
            a.href = '#'+heading.id;
            a.classList.add('inpage_heading');
            heading.innerHTML = '';
            heading.appendChild(a);
          }
        });
      })();
    </script>
	</body>
</html>
