<!DOCTYPE html>
<html id="docs" lang="fr" class="">
	<head>
	

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-36037335-10');
</script>
<meta charset="utf-8">
<title>Configuration - Kubernetes</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#326ce5">
<link rel="shortcut icon" type="image/png" href="/images/favicon.png">









<link rel="stylesheet" href="/css/style.b7b8403eb5b1fddd0a2da2a8383d5b53e6ef81c23e4b0e292e6103bd91f9502d.css" integrity="sha256-t7hAPrWx/d0KLaKoOD1bU&#43;bvgcI&#43;Sw4pLmEDvZH5UC0=">


<link rel="stylesheet" href="/css/base_fonts.css">
<link rel="stylesheet" href="/css/jquery-ui.min.css">
<link rel="stylesheet" href="/css/callouts.css">
<link rel="stylesheet" href="/css/custom-jekyll/tags.css">



<meta name="description" content="">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:url" content="https://kubernetes.io/fr/docs/concepts/configuration/">
<meta property="og:title" content="Configuration">
<meta name="twitter:title" content="Configuration">
<meta name="twitter:image" content="https://kubernetes.io/images/favicon.png" />

<meta name="twitter:image:alt" content="Kubernetes">

<meta property="og:image" content="/images/kubernetes-horizontal-color.png">

<meta property="og:type" content="article">
<script src="/js/anchor-4.1.1.min.js"></script>
<script src="/js/jquery-3.2.1.min.js"></script>
<script src="/js/jquery-ui-1.12.1.min.js"></script>
<script src="/js/bootstrap-4.3.1.min.js"></script>
<script src="/js/sweetalert-2.1.2.min.js"></script>

<script src="/js/script.js"></script>
<script src="/js/custom-jekyll/tags.js"></script>


	</head>
	<body>
		<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/fr/" class="logo" title="Solution professionnelle d’orchestration de conteneurs - Kubernetes" aria-label="Kubernetes website"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            
            
            <li><a href="/fr/docs/" class="active">Documentation</a></li>
            
            <li><a href="/fr/blog/">Blog</a></li>
            
            
            
            <li><a href="/fr/partners/">Partenaires</a></li>
            
            <li><a href="/fr/community/">Communauté</a></li>
            
            <li><a href="/fr/case-studies/">Études de cas</a></li>
            
            
            
             <li>
                <a href="#">
                    Français <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="/docs/concepts/configuration/">English</a></li>
                
                    <li><a href="/zh/docs/concepts/configuration/">中文 Chinese</a></li>
                
                    <li><a href="/ko/docs/concepts/configuration/">한국어 Korean</a></li>
                
                    <li><a href="/ja/docs/concepts/configuration/">日本語 Japanese</a></li>
                
                    <li><a href="/de/docs/concepts/configuration/">Deutsch</a></li>
                
                    <li><a href="/es/docs/concepts/configuration/">Español</a></li>
                
                    <li><a href="/id/docs/concepts/configuration/">Bahasa Indonesia</a></li>
                
                </ul>
            </li>

            <li>
                <a href="#">
                    v1.17 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="https://kubernetes.io/fr/docs/concepts/configuration/">v1.21</a></li>
                
                    <li><a href="https://v1-20.docs.kubernetes.io/fr/docs/concepts/configuration/">v1.20</a></li>
                
                    <li><a href="https://v1-19.docs.kubernetes.io/fr/docs/concepts/configuration/">v1.19</a></li>
                
                    <li><a href="https://v1-18.docs.kubernetes.io/fr/docs/concepts/configuration/">v1.18</a></li>
                
                    <li><a href="https://v1-17.docs.kubernetes.io/fr/docs/concepts/configuration/">v1.17</a></li>
                
                </ul>
            </li>
        </ul>
        
        <a href="/fr/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>Apprendre les bases de Kubernetes</a>
        

        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <div class="main-section" data-auto-burger="primary">
         
           <div class="nav-box">
            <h3><a href="/fr/docs/tutorials/hello-minikube/">Démarrer</a></h3>
           <p>Prêt à mettre les mains dans le cambouis ? Créez un cluster Kubernetes simple qui exécute "Hello World" avec Node.js.</p>>.

            </div>
         
           <div class="nav-box">
            <h3><a href="/fr/docs/home/">Documentation</a></h3>
           <p>Apprenez à utiliser Kubernetes à l'aide d'une documentation conceptuelle, didactique et de référence. Vous pouvez même <a href="/editdocs/" data-auto-burger-exclude>aider en contribuant à la documentation</a>!</p>

            </div>
         
           <div class="nav-box">
            <h3><a href="/fr/blog/">Blog</a></h3>
           <p>Lisez les dernières nouvelles à propos de Kubernetes et des conteneurs en général. Obtenez les derniers tutoriels techniques.</p>

            </div>
         
        </div>
        <div class="main-section" data-auto-burger="primary">
            <div class="left">
                <h5 class="github-invite">Souhaitez vous contribuer au code de Kubernetes ?</h5>
                <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>Voir sur GitHub</a>
            </div>

            <div class="right">
                <h5 class="github-invite">Explorez la communauté</h5>
                <div class="social">
                    <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                    <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                    <a href="http://slack.k8s.io/" class="slack"><span>Slack Slack</span></a>
                    <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                    <a href="https://www.youtube.com/kubernetescommunity" class="youtube"><span>YouTube</span></a>
                    <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                    <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Calendrier</span></a>
                </div>
            </div>
            <div class="clear" style="clear: both"></div>
        </div>
    </nav>
</header>

		
		
		<section id="hero" class="light-text no-sub">
			









<h1>Concepts</h1>
<h5></h5>










<div id="vendorStrip" class="light-text">
	<ul>
		
		
		<li><a href="/fr/docs/home/">ACCUEIL</a></li>
		
		
		<li><a href="/fr/docs/setup/">INSTALLATION</a></li>
		
		
		<li><a href="/fr/docs/concepts/" class="YAH">CONCEPTS</a></li>
		
		
		<li><a href="/fr/docs/tasks/">TÂCHES</a></li>
		
		
		<li><a href="/fr/docs/tutorials/">TUTORIELS</a></li>
		
		
		<li><a href="/fr/docs/reference/">RÉFÉRENCE</a></li>
		
		
		<li><a href="/fr/docs/contribute/">CONTRIBUER</a></li>
		
	</ul>
	<form id="searchBox" action="/docs/search/" role="search">
		<input type="text" id="search" name="q" placeholder="Recherche" aria-label="Search">
	</form>
</div>

		</section>
		
    
		
<section id="deprecationWarning">
  <main>
    <div class="content deprecation-warning">
      <h3>
	 Kubernetes v1.17
	  documentation non maintenue. Vous consultez une version statique. Pour une documentation à jour, veuillez consulter: 
	 <a href="https://kubernetes.io/docs/home/">dernière version.</a>
      </h3>
    </div>
  </main>
</section>


    <main>
        <section id="encyclopedia">
          
<div id="docsToc">
     <div class="pi-accordion">
    	
        
        
        
        
        
         
             
                 
             
         
             
                 
             
         
             
                 
                          
                          
                 
             
         
             
         
             
         
             
         
             
         
             
         
         
        
        <a class="item" data-title="Concepts" href="/fr/docs/concepts/"></a>

	
	
			
			
			
			
			
		
	
	
	
		
			
<div class="item" data-title="Vue d&#39;ensemble">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Qu&#39;est-ce-que Kubernetes ?" href="/fr/docs/concepts/overview/what-is-kubernetes/"></a>

		
	
		
			

<a class="item" data-title="Composants de Kubernetes" href="/fr/docs/concepts/overview/components/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="The Kubernetes API <small>(EN)</small>" href="/docs/concepts/overview/kubernetes-api/"></a>

		
	
		
			
<div class="item" data-title="Utilisation des objets Kubernetes">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Understanding Kubernetes Objects <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/kubernetes-objects/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Kubernetes Object Management <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/object-management/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Object Names and IDs <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/names/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Namespaces <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/namespaces/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Labels and Selectors <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/labels/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Annotations <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/annotations/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Field Selectors <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/field-selectors/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Recommended Labels <small>(EN)</small>" href="/docs/concepts/overview/working-with-objects/common-labels/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Architecture de Kubernetes">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Noeuds" href="/fr/docs/concepts/architecture/nodes/"></a>

		
	
		
			

<a class="item" data-title="Communication Master-Node" href="/fr/docs/concepts/architecture/master-node-communication/"></a>

		
	
		
			

<a class="item" data-title="Concepts sous-jacents au Cloud Controller Manager" href="/fr/docs/concepts/architecture/cloud-controller/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Controllers <small>(EN)</small>" href="/docs/concepts/architecture/controller/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Les conteneurs">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Containers overview <small>(EN)</small>" href="/docs/concepts/containers/overview/"></a>

		
	
		
			

<a class="item" data-title="Images" href="/fr/docs/concepts/containers/images/"></a>

		
	
		
			

<a class="item" data-title="Classe d&#39;exécution (Runtime Class)" href="/fr/docs/concepts/containers/runtime-class/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Container Environment <small>(EN)</small>" href="/docs/concepts/containers/container-environment/"></a>

		
	
		
			

<a class="item" data-title="Les variables d’environnement du conteneur" href="/fr/docs/concepts/containers/container-environment-variables/"></a>

		
	
		
			

<a class="item" data-title="Hooks de cycle de vie de conteneurs" href="/fr/docs/concepts/containers/container-lifecycle-hooks/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Workloads">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			
<div class="item" data-title="Pods">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Aperçu du Pod" href="/fr/docs/concepts/workloads/pods/pod-overview/"></a>

		
	
		
			

<a class="item" data-title="Pods" href="/fr/docs/concepts/workloads/pods/pod/"></a>

		
	
		
			

<a class="item" data-title="Cycle de vie d&#39;un Pod" href="/fr/docs/concepts/workloads/pods/pod-lifecycle/"></a>

		
	
		
			

<a class="item" data-title="Init Containers" href="/fr/docs/concepts/workloads/pods/init-containers/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Pod Preset <small>(EN)</small>" href="/docs/concepts/workloads/pods/podpreset/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Pod Topology Spread Constraints <small>(EN)</small>" href="/docs/concepts/workloads/pods/pod-topology-spread-constraints/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Disruptions <small>(EN)</small>" href="/docs/concepts/workloads/pods/disruptions/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Ephemeral Containers <small>(EN)</small>" href="/docs/concepts/workloads/pods/ephemeral-containers/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Contrôleurs">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="ReplicaSet" href="/fr/docs/concepts/workloads/controllers/replicaset/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="ReplicationController <small>(EN)</small>" href="/docs/concepts/workloads/controllers/replicationcontroller/"></a>

		
	
		
			

<a class="item" data-title="Déploiements" href="/fr/docs/concepts/workloads/controllers/deployment/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="StatefulSets <small>(EN)</small>" href="/docs/concepts/workloads/controllers/statefulset/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="DaemonSet <small>(EN)</small>" href="/docs/concepts/workloads/controllers/daemonset/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Garbage Collection <small>(EN)</small>" href="/docs/concepts/workloads/controllers/garbage-collection/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="TTL Controller for Finished Resources <small>(EN)</small>" href="/docs/concepts/workloads/controllers/ttlafterfinished/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Jobs - Run to Completion <small>(EN)</small>" href="/docs/concepts/workloads/controllers/jobs-run-to-completion/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="CronJob <small>(EN)</small>" href="/docs/concepts/workloads/controllers/cron-jobs/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Services, Equilibreur de charge, et Réseau">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="EndpointSlices <small>(EN)</small>" href="/docs/concepts/services-networking/endpoint-slices/"></a>

		
	
		
			

<a class="item" data-title="Service" href="/fr/docs/concepts/services-networking/service/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Service Topology <small>(EN)</small>" href="/docs/concepts/services-networking/service-topology/"></a>

		
	
		
			

<a class="item" data-title="DNS pour les services et les pods" href="/fr/docs/concepts/services-networking/dns-pod-service/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Connecting Applications with Services <small>(EN)</small>" href="/docs/concepts/services-networking/connect-applications-service/"></a>

		
	
		
			

<a class="item" data-title="Ingress" href="/fr/docs/concepts/services-networking/ingress/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Ingress Controllers <small>(EN)</small>" href="/docs/concepts/services-networking/ingress-controllers/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Network Policies <small>(EN)</small>" href="/docs/concepts/services-networking/network-policies/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Adding entries to Pod /etc/hosts with HostAliases <small>(EN)</small>" href="/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="IPv4/IPv6 dual-stack <small>(EN)</small>" href="/docs/concepts/services-networking/dual-stack/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Stockage">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Volumes" href="/fr/docs/concepts/storage/volumes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Volume Snapshots <small>(EN)</small>" href="/docs/concepts/storage/volume-snapshots/"></a>

		
	
		
			

<a class="item" data-title="Volumes persistants" href="/fr/docs/concepts/storage/persistent-volumes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="CSI Volume Cloning <small>(EN)</small>" href="/docs/concepts/storage/volume-pvc-datasource/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Storage Classes <small>(EN)</small>" href="/docs/concepts/storage/storage-classes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Volume Snapshot Classes <small>(EN)</small>" href="/docs/concepts/storage/volume-snapshot-classes/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Dynamic Volume Provisioning <small>(EN)</small>" href="/docs/concepts/storage/dynamic-provisioning/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Node-specific Volume Limits <small>(EN)</small>" href="/docs/concepts/storage/storage-limits/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Configuration">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Configuration Best Practices <small>(EN)</small>" href="/docs/concepts/configuration/overview/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Resource Bin Packing for Extended Resources <small>(EN)</small>" href="/docs/concepts/configuration/resource-bin-packing/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Managing Compute Resources for Containers <small>(EN)</small>" href="/docs/concepts/configuration/manage-compute-resources-container/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Pod Overhead <small>(EN)</small>" href="/docs/concepts/configuration/pod-overhead/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Assigning Pods to Nodes <small>(EN)</small>" href="/docs/concepts/configuration/assign-pod-node/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Taints and Tolerations <small>(EN)</small>" href="/docs/concepts/configuration/taint-and-toleration/"></a>

		
	
		
			

<a class="item" data-title="Secrets" href="/fr/docs/concepts/configuration/secret/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Organizing Cluster Access Using kubeconfig Files <small>(EN)</small>" href="/docs/concepts/configuration/organize-cluster-access-kubeconfig/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Pod Priority and Preemption <small>(EN)</small>" href="/docs/concepts/configuration/pod-priority-preemption/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Scheduling Framework <small>(EN)</small>" href="/docs/concepts/configuration/scheduling-framework/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Sécurité">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Overview of Cloud Native Security <small>(EN)</small>" href="/docs/concepts/security/overview/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Politiques">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Limit Ranges <small>(EN)</small>" href="/docs/concepts/policy/limit-range/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Resource Quotas <small>(EN)</small>" href="/docs/concepts/policy/resource-quotas/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Pod Security Policies <small>(EN)</small>" href="/docs/concepts/policy/pod-security-policy/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Scheduling">
	<div class="container">
		
		
	
	
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Kubernetes Scheduler <small>(EN)</small>" href="/docs/concepts/scheduling/kube-scheduler/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Scheduler Performance Tuning <small>(EN)</small>" href="/docs/concepts/scheduling/scheduler-perf-tuning/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Administration d&#39;un cluster">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Vue d&#39;ensemble de l&#39;administration d&#39;un cluster" href="/fr/docs/concepts/cluster-administration/cluster-administration-overview/"></a>

		
	
		
			

<a class="item" data-title="Certificats" href="/fr/docs/concepts/cluster-administration/certificates/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Cloud Providers <small>(EN)</small>" href="/docs/concepts/cluster-administration/cloud-providers/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Managing Resources <small>(EN)</small>" href="/docs/concepts/cluster-administration/manage-deployment/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Cluster Networking <small>(EN)</small>" href="/docs/concepts/cluster-administration/networking/"></a>

		
	
		
			

<a class="item" data-title="Architecture de Journalisation d&#39;évènements (logging)" href="/fr/docs/concepts/cluster-administration/logging/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Metrics For The Kubernetes Control Plane <small>(EN)</small>" href="/docs/concepts/cluster-administration/monitoring/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Configuring kubelet Garbage Collection <small>(EN)</small>" href="/docs/concepts/cluster-administration/kubelet-garbage-collection/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Proxies in Kubernetes <small>(EN)</small>" href="/docs/concepts/cluster-administration/proxies/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Installing Addons <small>(EN)</small>" href="/docs/concepts/cluster-administration/addons/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Extensions Kubernetes">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Extending your Kubernetes Cluster <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/extend-cluster/"></a>

		
	
		
			
<div class="item" data-title="Extensions de l&#39;API Kubernetes">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Custom Resources <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/api-extension/custom-resources/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Extending the Kubernetes API with the aggregation layer <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/api-extension/apiserver-aggregation/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Extensions compute, stockage et réseau">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Network Plugins <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Device Plugins <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/compute-storage-net/device-plugins/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" target="_blank" data-title="Operator pattern <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/operator/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Service Catalog <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/service-catalog/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Poseidon-Firmament Scheduler <small>(EN)</small>" href="/docs/concepts/extend-kubernetes/poseidon-firmament-alternate-scheduler/"></a>

		
	

	</div>
</div>

		
	





     </div> 
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 


          <div id="docsContent">
            
    
    
    
    
    
    
	 
    
    
    
<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/fr/docs/concepts/configuration/secret.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>

<h1>Secrets</h1>



<p>Les objets <code>secret</code> de Kubernetes vous permettent de stocker et de gérer des informations sensibles, telles que les mots de passe, les jetons OAuth et les clés ssh.
Mettre ces informations dans un <code>secret</code> est plus sûr et plus flexible que de le mettre en dur dans la définition d&rsquo;un <a class='glossary-tooltip' href='/fr/docs/concepts/workloads/pods/pod-overview/' target='_blank'>Pod<span class='tooltip-text'>Le plus petit et le plus simple des objets Kubernetes. Un Pod est un ensemble de conteneurs fonctionnant sur votre cluster.</span>
</a> ou dans une <a class='glossary-tooltip' href='/fr/docs/reference/glossary/?all=true#term-image' target='_blank'>container image<span class='tooltip-text'>Instance stockée d&rsquo;un conteneur qui contient un ensemble de logiciels nécessaires à l&rsquo;exécution d&rsquo;une application.</span>
</a>.
Voir <a href="https://git.k8s.io/community/contributors/design-proposals/auth/secrets.md" target="_blank">Document de conception des secrets</a> pour plus d&rsquo;informations.</p>









<ul id="markdown-toc">










<li><a href="#pr%c3%a9sentation-des-secrets">Présentation des secrets</a></li>




<li><a href="#utiliser-les-secrets">Utiliser les secrets</a></li>




<li><a href="#details">Details</a></li>




<li><a href="#cas-d-utilisation">Cas d’utilisation</a></li>




<li><a href="#les-meilleures-pratiques">Les meilleures pratiques</a></li>




<li><a href="#propri%c3%a9t%c3%a9s-de-s%c3%a9curit%c3%a9">Propriétés de sécurité</a></li>



















</ul>


<h2 id="présentation-des-secrets">Présentation des secrets</h2>

<p>Un secret est un objet qui contient une petite quantité de données sensibles telles qu&rsquo;un mot de passe, un jeton ou une clé.
De telles informations pourraient autrement être placées dans une spécification de pod ou dans une image; le placer dans un objet secret permet de mieux contrôler la façon dont il est utilisé et réduit le risque d&rsquo;exposition accidentelle.</p>

<p>Les utilisateurs peuvent créer des secrets et le système crée également des secrets.</p>

<p>Pour utiliser un secret, un pod doit référencer le secret.
Un secret peut être utilisé avec un pod de deux manières: sous forme de fichiers dans un <a class='glossary-tooltip' href='/docs/concepts/storage/volumes/' target='_blank'>volume<span class='tooltip-text'>A directory containing data, accessible to the containers in a pod.</span>
</a> monté sur un ou plusieurs de ses conteneurs, ou utilisé par kubelet lorsque vous récupérez des images pour le pod.</p>

<h3 id="secrets-intégrés">Secrets intégrés</h3>

<h4 id="les-comptes-de-service-créent-et-attachent-automatiquement-des-secrets-avec-les-informations-d-identification-de-l-api">Les comptes de service créent et attachent automatiquement des secrets avec les informations d&rsquo;identification de l&rsquo;API</h4>

<p>Kubernetes crée automatiquement des secrets qui contiennent des informations d&rsquo;identification pour accéder à l&rsquo;API et il modifie automatiquement vos pods pour utiliser ce type de secret.</p>

<p>La création et l&rsquo;utilisation automatiques des informations d&rsquo;identification de l&rsquo;API peuvent être désactivées ou remplacées si vous le souhaitez.
Cependant, si tout ce que vous avez à faire est d&rsquo;accéder en toute sécurité à l&rsquo;apiserver, il s&rsquo;agit de la méthode recommandée.</p>

<p>Voir la documentation des <a href="/docs/tasks/configure-pod-container/configure-service-account/">Compte de service</a> pour plus d&rsquo;informations sur le fonctionnement des comptes de service.</p>

<h3 id="créer-vos-propres-secrets">Créer vos propres secrets</h3>

<h4 id="créer-un-secret-avec-kubectl-create-secret">Créer un secret avec kubectl create secret</h4>

<p>Supposons que certains pods doivent accéder à une base de données.
Le nom d&rsquo;utilisateur et le mot de passe que les pods doivent utiliser se trouvent dans les fichiers <code>./username.txt</code> et <code>./password.txt</code> sur votre machine locale.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#080;font-style:italic"># Create files needed for rest of example.</span>
<span style="color:#a2f">echo</span> -n <span style="color:#b44">&#39;admin&#39;</span> &gt; ./username.txt
<span style="color:#a2f">echo</span> -n <span style="color:#b44">&#39;1f2d1e2e67df&#39;</span> &gt; ./password.txt</code></pre></div>
<p>La commande <code>kubectl create secret</code> regroupe ces fichiers dans un secret et crée l&rsquo;objet sur l&rsquo;Apiserver.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create secret generic db-user-pass --from-file<span style="color:#666">=</span>./username.txt --from-file<span style="color:#666">=</span>./password.txt</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">secret &#34;db-user-pass&#34; created</code></pre></div>
<blockquote class="note">
  <div><strong>Note:</strong> <p>Les caractères spéciaux tels que <code>$</code>, <code>\</code>, <code>*</code>, et <code>!</code> seront interprétés par votre <a href="https://en.wikipedia.org/wiki/Shell_(computing)" target="_blank">shell</a> et nécessitent d&rsquo;être échappés.
Dans les shells les plus courants, le moyen le plus simple d&rsquo;échapper au mot de passe est de l&rsquo;entourer de guillemets simples (<code>'</code>).
Par exemple, si votre mot de passe réel est <code>S!B\*d$zDsb</code>, vous devez exécuter la commande de cette façon:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">kubectl create secret generic dev-db-secret --from-literal=username=devuser --from-literal=password=&#39;S!B\*d$zDsb&#39;</code></pre></div>
<p>Vous n&rsquo;avez pas besoin d&rsquo;échapper les caractères spéciaux dans les mots de passe des fichiers (<code>--from-file</code>).</p>
</div>
</blockquote>

<p>Vous pouvez vérifier que le secret a été créé comme ceci:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl get secrets</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">NAME                  TYPE                                  DATA      AGE
db-user-pass          Opaque                                2         51s</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">kubectl describe secrets/db-user-pass</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Name:            db-user-pass
Namespace:       default
Labels:          &lt;none&gt;
Annotations:     &lt;none&gt;

Type:            Opaque

Data
====
password.txt:    12 bytes
username.txt:    5 bytes</code></pre></div>
<blockquote class="note">
  <div><strong>Note:</strong> <code>kubectl get</code> et <code>kubectl describe</code> évitent d&rsquo;afficher le contenu d&rsquo;un secret par défaut.
Il s&rsquo;agit de protéger le secret contre une exposition accidentelle à un spectateur de l&rsquo;écran ou contre son stockage dans un journal de terminal.</div>
</blockquote>

<p>Voir <a href="#decoding-a-secret">décoder un secret</a> pour voir le contenu d&rsquo;un secret.</p>

<h4 id="création-manuelle-d-un-secret">Création manuelle d&rsquo;un secret</h4>

<p>Vous pouvez également créer un secret dans un fichier d&rsquo;abord, au format json ou yaml, puis créer cet objet.
Le <a href="/docs/reference/generated/kubernetes-api/v1.17/#secret-v1-core">secret</a> contient deux table de hachage: <code>data</code> et <code>stringData</code>.
Le champ <code>data</code> est utilisé pour stocker des données arbitraires, encodées en base64.
Le champ <code>stringData</code> est fourni pour plus de commodité et vous permet de fournir des données secrètes sous forme de chaînes non codées.</p>

<p>Par exemple, pour stocker deux chaînes dans un secret à l&rsquo;aide du champ <code>data</code>, convertissez-les en base64 comme suit:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#a2f">echo</span> -n <span style="color:#b44">&#39;admin&#39;</span> | base64
<span style="color:#b8860b">YWRtaW4</span><span style="color:#666">=</span>
<span style="color:#a2f">echo</span> -n <span style="color:#b44">&#39;1f2d1e2e67df&#39;</span> | base64
MWYyZDFlMmU2N2Rm</code></pre></div>
<p>Écrivez un secret qui ressemble à ceci:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb"></span>type:<span style="color:#bbb"> </span>Opaque<span style="color:#bbb">
</span><span style="color:#bbb"></span>data:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>username:<span style="color:#bbb"> </span>YWRtaW4=<span style="color:#bbb">
</span><span style="color:#bbb">  </span>password:<span style="color:#bbb"> </span>MWYyZDFlMmU2N2Rm</code></pre></div>
<p>Maintenant, créez le secret en utilisant <a href="/docs/reference/generated/kubectl/kubectl-commands#apply"><code>kubectl apply</code></a>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">kubectl apply -f ./secret.yaml</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">secret &#34;mysecret&#34; created</code></pre></div>
<p>Pour certains scénarios, vous pouvez utiliser le champ <code>stringData</code> à la place.
Ce champ vous permet de mettre une chaîne non codée en base64 directement dans le secret, et la chaîne sera codée pour vous lorsque le secret sera créé ou mis à jour.</p>

<p>Un exemple pratique de cela pourrait être le suivant: vous déployez une application qui utilise un secret pour stocker un fichier de configuration.
Vous souhaitez remplir des parties de ce fichier de configuration pendant votre processus de déploiement.</p>

<p>Si votre application utilise le fichier de configuration suivant:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiUrl:<span style="color:#bbb"> </span><span style="color:#b44">&#34;https://my.api.com/api/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>username:<span style="color:#bbb"> </span><span style="color:#b44">&#34;user&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>password:<span style="color:#bbb"> </span><span style="color:#b44">&#34;password&#34;</span></code></pre></div>
<p>Vous pouvez stocker cela dans un secret en utilisant ce qui suit:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb"></span>type:<span style="color:#bbb"> </span>Opaque<span style="color:#bbb">
</span><span style="color:#bbb"></span>stringData:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>config.yaml:<span style="color:#bbb"> </span>|<span style="color:#b44;font-style:italic">-
</span><span style="color:#b44;font-style:italic">    apiUrl: &#34;https://my.api.com/api/v1&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>username:<span style="color:#bbb"> </span>{{username}}<span style="color:#bbb">
</span><span style="color:#bbb">    </span>password:<span style="color:#bbb"> </span>{{password}}</code></pre></div>
<p>Votre outil de déploiement pourrait alors remplacer les variables de modèle <code>{{username}}</code> et <code>{{password}}</code> avant d&rsquo;exécuter <code>kubectl apply</code>.</p>

<p><code>stringData</code> est un champ de commodité en écriture seule.
Il n&rsquo;est jamais affiché lors de la récupération des secrets.
Par exemple, si vous exécutez la commande suivante:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">kubectl get secret mysecret -o yaml</code></pre></div>
<p>La sortie sera similaire à:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>creationTimestamp:<span style="color:#bbb"> </span>2018-11-15T20:40:59Z<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb">  </span>namespace:<span style="color:#bbb"> </span>default<span style="color:#bbb">
</span><span style="color:#bbb">  </span>resourceVersion:<span style="color:#bbb"> </span><span style="color:#b44">&#34;7225&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>uid:<span style="color:#bbb"> </span>c280ad2e-e916<span style="color:#666">-11e8</span>-98f2<span style="color:#666">-025000000001</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>type:<span style="color:#bbb"> </span>Opaque<span style="color:#bbb">
</span><span style="color:#bbb"></span>data:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>config.yaml:<span style="color:#bbb"> </span>YXBpVXJsOiAiaHR0cHM6Ly9teS5hcGkuY29tL2FwaS92MSIKdXNlcm5hbWU6IHt7dXNlcm5hbWV9fQpwYXNzd29yZDoge3twYXNzd29yZH19</code></pre></div>
<p>Si un champ est spécifié à la fois dans <code>data</code> et <code>stringData</code>, la valeur de <code>stringData</code> est utilisée.
Par exemple, la définition de secret suivante:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb"></span>type:<span style="color:#bbb"> </span>Opaque<span style="color:#bbb">
</span><span style="color:#bbb"></span>data:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>username:<span style="color:#bbb"> </span>YWRtaW4=<span style="color:#bbb">
</span><span style="color:#bbb"></span>stringData:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>username:<span style="color:#bbb"> </span>administrator</code></pre></div>
<p>Donnera le secret suivant:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>creationTimestamp:<span style="color:#bbb"> </span>2018-11-15T20:46:46Z<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb">  </span>namespace:<span style="color:#bbb"> </span>default<span style="color:#bbb">
</span><span style="color:#bbb">  </span>resourceVersion:<span style="color:#bbb"> </span><span style="color:#b44">&#34;7579&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>uid:<span style="color:#bbb"> </span>91460ecb-e917<span style="color:#666">-11e8</span>-98f2<span style="color:#666">-025000000001</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>type:<span style="color:#bbb"> </span>Opaque<span style="color:#bbb">
</span><span style="color:#bbb"></span>data:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>username:<span style="color:#bbb"> </span>YWRtaW5pc3RyYXRvcg==</code></pre></div>
<p>Où <code>YWRtaW5pc3RyYXRvcg ==</code> décode en <code>administrateur</code>.</p>

<p>Les clés de <code>data</code> et <code>stringData</code> doivent être composées de caractères alphanumériques, &lsquo;-&rsquo;, &lsquo;_&rsquo; ou &lsquo;.&rsquo;.</p>

<p><strong>Encoding Note:</strong> Les valeurs JSON et YAML sérialisées des données secrètes sont codées sous forme de chaînes base64.
Les sauts de ligne ne sont pas valides dans ces chaînes et doivent être omis.
Lors de l&rsquo;utilisation de l&rsquo;utilitaire <code>base64</code> sur Darwin / macOS, les utilisateurs doivent éviter d&rsquo;utiliser l&rsquo;option <code>-b</code> pour diviser les longues lignes.
Inversement, les utilisateurs Linux <em>devraient</em> ajouter l&rsquo;option <code>-w 0</code> aux commandes <code>base64</code> ou le pipeline <code>base64 | tr -d '\ n'</code> si l&rsquo;option <code>-w</code> n&rsquo;est pas disponible.</p>

<h4 id="création-d-un-secret-à-partir-du-générateur">Création d&rsquo;un secret à partir du générateur</h4>

<p>Kubectl prend en charge <a href="/docs/tasks/manage-kubernetes-objects/kustomization/">la gestion des objets à l&rsquo;aide de Kustomize</a> depuis 1.14.
Avec cette nouvelle fonctionnalité, vous pouvez également créer un secret à partir de générateurs, puis l&rsquo;appliquer pour créer l&rsquo;objet sur l&rsquo;Apiserver.
Les générateurs doivent être spécifiés dans un <code>kustomization.yaml</code> à l&rsquo;intérieur d&rsquo;un répertoire.</p>

<p>Par exemple, pour générer un secret à partir des fichiers <code>./username.txt</code> et <code>./password.txt</code></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#080;font-style:italic"># Create a kustomization.yaml file with SecretGenerator</span>
cat <span style="color:#b44">&lt;&lt;EOF &gt;./kustomization.yaml
</span><span style="color:#b44">secretGenerator:
</span><span style="color:#b44">- name: db-user-pass
</span><span style="color:#b44">  files:
</span><span style="color:#b44">  - username.txt
</span><span style="color:#b44">  - password.txt
</span><span style="color:#b44">EOF</span></code></pre></div>
<p>Appliquez le répertoire de personnalisation pour créer l&rsquo;objet secret.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">$ kubectl apply -k .
secret/db-user-pass-96mffmfh4k created</code></pre></div>
<p>Vous pouvez vérifier que le secret a été créé comme ceci:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">$ kubectl get secrets
NAME                             TYPE                                  DATA      AGE
db-user-pass-96mffmfh4k          Opaque                                2         51s

$ kubectl describe secrets/db-user-pass-96mffmfh4k
Name:            db-user-pass
Namespace:       default
Labels:          &lt;none&gt;
Annotations:     &lt;none&gt;

Type:            Opaque

Data
====
password.txt:    12 bytes
username.txt:    5 bytes</code></pre></div>
<p>Par exemple, pour générer un secret à partir des littéraux <code>username=admin</code> et <code>password=secret</code>, vous pouvez spécifier le générateur de secret dans <code>kustomization.yaml</code> comme:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#080;font-style:italic"># Create a kustomization.yaml file with SecretGenerator</span>
$ cat <span style="color:#b44">&lt;&lt;EOF &gt;./kustomization.yaml
</span><span style="color:#b44">secretGenerator:
</span><span style="color:#b44">- name: db-user-pass
</span><span style="color:#b44">  literals:
</span><span style="color:#b44">  - username=admin
</span><span style="color:#b44">  - password=secret
</span><span style="color:#b44">EOF</span></code></pre></div>
<p>Appliquer le repertoire kustomization pour créer l&rsquo;objet secret.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ kubectl apply -k .
secret/db-user-pass-dddghtt9b5 created</code></pre></div>
<blockquote class="note">
  <div><strong>Note:</strong> Le nom des secrets généré a un suffixe ajouté en hachant le contenu.
Cela garantit qu&rsquo;un nouveau secret est généré chaque fois que le contenu est modifié.</div>
</blockquote>

<h4 id="décoder-un-secret">Décoder un secret</h4>

<p>Les secrets peuvent être récupérés via la command <code>kubectl get secret</code>.
Par exemple, pour récupérer le secret créé dans la section précédente:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl get secret mysecret -o yaml</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>creationTimestamp:<span style="color:#bbb"> </span>2016-01-22T18:41:56Z<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb">  </span>namespace:<span style="color:#bbb"> </span>default<span style="color:#bbb">
</span><span style="color:#bbb">  </span>resourceVersion:<span style="color:#bbb"> </span><span style="color:#b44">&#34;164619&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>uid:<span style="color:#bbb"> </span>cfee02d6-c137<span style="color:#666">-11e5</span>-8d73-42010af00002<span style="color:#bbb">
</span><span style="color:#bbb"></span>type:<span style="color:#bbb"> </span>Opaque<span style="color:#bbb">
</span><span style="color:#bbb"></span>data:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>username:<span style="color:#bbb"> </span>YWRtaW4=<span style="color:#bbb">
</span><span style="color:#bbb">  </span>password:<span style="color:#bbb"> </span>MWYyZDFlMmU2N2Rm</code></pre></div>
<p>Décodez le champ du mot de passe:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#a2f">echo</span> <span style="color:#b44">&#39;MWYyZDFlMmU2N2Rm&#39;</span> | base64 --decode</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">1f2d1e2e67df</code></pre></div>
<h4 id="modification-d-un-secret">Modification d&rsquo;un secret</h4>

<p>Un secret existant peut être modifié avec la commande suivante:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">kubectl edit secrets mysecret</code></pre></div>
<p>Cela ouvrira l&rsquo;éditeur configuré par défaut et permettra de mettre à jour les valeurs secrètes codées en base64 dans le champ <code>data</code>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#080;font-style:italic"># Please edit the object below. Lines beginning with a &#39;#&#39; will be ignored,</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#080;font-style:italic"># and an empty file will abort the edit. If an error occurs while saving this file will be</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#080;font-style:italic"># reopened with the relevant failures.</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#080;font-style:italic">#</span><span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>data:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>username:<span style="color:#bbb"> </span>YWRtaW4=<span style="color:#bbb">
</span><span style="color:#bbb">  </span>password:<span style="color:#bbb"> </span>MWYyZDFlMmU2N2Rm<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>annotations:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>kubectl.kubernetes.io/last-applied-configuration:<span style="color:#bbb"> </span>{<span style="color:#bbb"> </span>...<span style="color:#bbb"> </span>}<span style="color:#bbb">
</span><span style="color:#bbb">  </span>creationTimestamp:<span style="color:#bbb"> </span>2016-01-22T18:41:56Z<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb">  </span>namespace:<span style="color:#bbb"> </span>default<span style="color:#bbb">
</span><span style="color:#bbb">  </span>resourceVersion:<span style="color:#bbb"> </span><span style="color:#b44">&#34;164619&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>uid:<span style="color:#bbb"> </span>cfee02d6-c137<span style="color:#666">-11e5</span>-8d73-42010af00002<span style="color:#bbb">
</span><span style="color:#bbb"></span>type:<span style="color:#bbb"> </span>Opaque</code></pre></div>
<h2 id="utiliser-les-secrets">Utiliser les secrets</h2>

<p>Les secrets peuvent être montés en tant que volumes de données ou être exposés en tant que <a class='glossary-tooltip' href='/docs/concepts/containers/container-environment-variables/' target='_blank'>variables d&#39;environnement<span class='tooltip-text'>Les variables d&rsquo;environnement de conteneur sont des paires nom=valeur qui fournissent des informations utiles aux conteneurs fonctionnant au sein d&rsquo;un Pod.</span>
</a> à utiliser par un conteneur dans un Pod.
Ils peuvent également être utilisés par d&rsquo;autres parties du système, sans être directement exposés aux Pods.
Par exemple, ils peuvent détenir des informations d&rsquo;identification que d&rsquo;autres parties du système doivent utiliser pour interagir avec des systèmes externes en votre nom.</p>

<h3 id="utilisation-de-secrets-comme-fichiers-d-un-pod">Utilisation de secrets comme fichiers d&rsquo;un pod</h3>

<p>Pour consommer un secret dans un volume dans un pod:</p>

<ol>
<li>Créez un secret ou utilisez-en un déjà existant.
Plusieurs Pods peuvent référencer le même secret.</li>
<li>Modifiez la définition de votre Pod pour ajouter un volume sous <code>.spec.volumes[]</code>.
Nommez le volume et ayez un champ <code>.spec.volumes[].secret.secretName</code> égal au nom de l&rsquo;objet secret.</li>
<li>Ajouter un <code>.spec.containers[].volumeMounts[]</code> à chaque conteneur qui a besoin du secret.
Spécifier <code>.spec.containers[].volumeMounts[].readOnly = true</code> et <code>.spec.containers[].volumeMounts[].mountPath</code> à un nom de répertoire inutilisé où vous souhaitez que les secrets apparaissent.</li>
<li>Modifiez votre image et/ou votre ligne de commande pour que le programme recherche les fichiers dans ce répertoire.
Chaque clé de la carte secrète <code>data</code> devient le nom de fichier sous <code>mountPath</code>.</li>
</ol>

<p>Voici un exemple de pod qui monte un secret dans un volume:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>redis<span style="color:#bbb">
</span><span style="color:#bbb">    </span>volumeMounts:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span><span style="color:#bbb">      </span>mountPath:<span style="color:#bbb"> </span><span style="color:#b44">&#34;/etc/foo&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>readOnly:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span><span style="color:#bbb">    </span>secret:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>secretName:<span style="color:#bbb"> </span>mysecret</code></pre></div>
<p>Chaque secret que vous souhaitez utiliser doit être mentionné dans <code>.spec.volumes</code>.</p>

<p>S&rsquo;il y a plusieurs conteneurs dans le pod, alors chaque conteneur a besoin de son propre bloc <code>volumeMounts</code>, mais un seul <code>.spec.volumes</code> est nécessaire par secret.</p>

<p>Vous pouvez regrouper de nombreux fichiers en un seul secret ou utiliser de nombreux secrets, selon le cas.</p>

<h3 id="projection-de-clés-secrètes-vers-des-chemins-spécifiques">Projection de clés secrètes vers des chemins spécifiques</h3>

<p>Nous pouvons également contrôler les chemins dans le volume où les clés secrètes sont projetées.
Vous pouvez utiliser le champ <code>.spec.volumes []. Secret.items</code> pour changer le chemin cible de chaque clé:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>redis<span style="color:#bbb">
</span><span style="color:#bbb">    </span>volumeMounts:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span><span style="color:#bbb">      </span>mountPath:<span style="color:#bbb"> </span><span style="color:#b44">&#34;/etc/foo&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>readOnly:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span><span style="color:#bbb">    </span>secret:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>secretName:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb">      </span>items:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>-<span style="color:#bbb"> </span>key:<span style="color:#bbb"> </span>username<span style="color:#bbb">
</span><span style="color:#bbb">        </span>path:<span style="color:#bbb"> </span>my-group/my-username</code></pre></div>
<p>Que se passera-t-il:</p>

<ul>
<li><code>username</code> est stocké dans le fichier <code>/etc/foo/my-group/my-username</code> au lieu de <code>/etc/foo/username</code>.</li>
<li><code>password</code> n&rsquo;est pas projeté</li>
</ul>

<p>Si <code>.spec.volumes[].secret.items</code> est utilisé, seules les clés spécifiées dans <code>items</code> sont projetées.
Pour consommer toutes les clés du secret, toutes doivent être répertoriées dans le champ <code>items</code>.
Toutes les clés répertoriées doivent exister dans le secret correspondant.
Sinon, le volume n&rsquo;est pas créé.</p>

<h3 id="autorisations-de-fichiers-secrets">Autorisations de fichiers secrets</h3>

<p>Vous pouvez également spécifier les bits de mode d&rsquo;autorisation des fichiers contenant les parties d&rsquo;un secret.
Si vous n&rsquo;en spécifiez pas, <code>0644</code> est utilisé par défaut.
Vous pouvez spécifier un mode par défaut pour tout le volume secret et remplacer par clé si nécessaire.</p>

<p>Par exemple, vous pouvez spécifier un mode par défaut comme celui-ci:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>redis<span style="color:#bbb">
</span><span style="color:#bbb">    </span>volumeMounts:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span><span style="color:#bbb">      </span>mountPath:<span style="color:#bbb"> </span><span style="color:#b44">&#34;/etc/foo&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span><span style="color:#bbb">    </span>secret:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>secretName:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb">      </span>defaultMode:<span style="color:#bbb"> </span><span style="color:#666">256</span></code></pre></div>
<p>Ensuite, le secret sera monté sur <code>/etc/foo</code> et tous les fichiers créés par le montage de volume secret auront la permission <code>0400</code>.</p>

<p>Notez que la spécification JSON ne prend pas en charge la notation octale, utilisez donc la valeur 256 pour les autorisations 0400.
Si vous utilisez yaml au lieu de json pour le pod, vous pouvez utiliser la notation octale pour spécifier les autorisations de manière plus naturelle.</p>

<p>Vous pouvez aussi utiliser un mapping, comme dans l&rsquo;exemple précédent, et spécifier des autorisations différentes pour différents fichiers comme celui-ci:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>mypod<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>redis<span style="color:#bbb">
</span><span style="color:#bbb">    </span>volumeMounts:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span><span style="color:#bbb">      </span>mountPath:<span style="color:#bbb"> </span><span style="color:#b44">&#34;/etc/foo&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>foo<span style="color:#bbb">
</span><span style="color:#bbb">    </span>secret:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>secretName:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb">      </span>items:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>-<span style="color:#bbb"> </span>key:<span style="color:#bbb"> </span>username<span style="color:#bbb">
</span><span style="color:#bbb">        </span>path:<span style="color:#bbb"> </span>my-group/my-username<span style="color:#bbb">
</span><span style="color:#bbb">        </span>mode:<span style="color:#bbb"> </span><span style="color:#666">511</span></code></pre></div>
<p>Dans ce cas, le fichier résultant <code>/etc/foo/my-group/my-username</code> aura la valeur d&rsquo;autorisation de <code>0777</code>.
En raison des limitations JSON, vous devez spécifier le mode en notation décimale.</p>

<p>Notez que cette valeur d&rsquo;autorisation peut être affichée en notation décimale si vous la lisez plus tard.</p>

<h3 id="consommer-des-valeurs-secrètes-à-partir-de-volumes">Consommer des valeurs secrètes à partir de volumes</h3>

<p>À l&rsquo;intérieur du conteneur qui monte un volume secret, les clés secrètes apparaissent sous forme de fichiers et les valeurs secrètes sont décodées en base 64 et stockées à l&rsquo;intérieur de ces fichiers.
C&rsquo;est le résultat des commandes exécutées à l&rsquo;intérieur du conteneur de l&rsquo;exemple ci-dessus:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">ls /etc/foo/</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">username
password</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cat /etc/foo/username</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">admin</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">cat /etc/foo/password</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">1f2d1e2e67df</code></pre></div>
<p>Le programme dans un conteneur est responsable de la lecture des secrets des fichiers.</p>

<h3 id="les-secrets-montés-sont-mis-à-jour-automatiquement">Les secrets montés sont mis à jour automatiquement</h3>

<p>Lorsqu&rsquo;un secret déjà consommé dans un volume est mis à jour, les clés projetées sont finalement mises à jour également.
Kubelet vérifie si le secret monté est récent à chaque synchronisation périodique.
Cependant, il utilise son cache local pour obtenir la valeur actuelle du Secret.
Le type de cache est configurable à l&rsquo;aide de le champ <code>ConfigMapAndSecretChangeDetectionStrategy</code> dans la structure <a href="https://github.com/kubernetes/kubernetes/blob/release-1.17/staging/src/k8s.io/kubelet/config/v1beta1/types.go" target="_blank">KubeletConfiguration</a>.
Il peut être soit propagé via watch (par défaut), basé sur ttl, ou simplement redirigé toutes les requêtes vers directement kube-apiserver.
Par conséquent, le délai total entre le moment où le secret est mis à jour et le moment où de nouvelles clés sont projetées sur le pod peut être aussi long que la période de synchronisation du kubelet + le délai de propagation du cache, où le délai de propagation du cache dépend du type de cache choisi (cela équivaut au delai de propagation du watch, ttl du cache, ou bien zéro).</p>

<blockquote class="note">
  <div><strong>Note:</strong> Un conteneur utilisant un secret comme un volume <a href="/docs/concepts/storage/volumes#using-subpath">subPath</a> monté ne recevra pas de mises à jour secrètes.</div>
</blockquote>

<h3 id="utilisation-de-secrets-comme-variables-d-environnement">Utilisation de secrets comme variables d&rsquo;environnement</h3>

<p>Pour utiliser un secret dans une <a class='glossary-tooltip' href='/docs/concepts/containers/container-environment-variables/' target='_blank'>variable d&#39;environnement<span class='tooltip-text'>Les variables d&rsquo;environnement de conteneur sont des paires nom=valeur qui fournissent des informations utiles aux conteneurs fonctionnant au sein d&rsquo;un Pod.</span>
</a> dans un pod:</p>

<ol>
<li>Créez un secret ou utilisez-en un déjà existant.
Plusieurs pods peuvent référencer le même secret.</li>
<li>Modifiez la définition de votre pod dans chaque conteneur où vous souhaitez utiliser la valeur d&rsquo;une clé secrète pour ajouter une variable d&rsquo;environnement pour chaque clé secrète que vous souhaitez consommer.
La variable d&rsquo;environnement qui consomme la clé secrète doit remplir le nom et la clé du secret dans <code>env[].valueFrom.secretKeyRef</code>.</li>
<li>Modifiez votre image et/ou votre ligne de commande pour que le programme recherche des valeurs dans les variables d&rsquo;environnement spécifiées</li>
</ol>

<p>Voici un exemple de pod qui utilise des secrets de variables d&rsquo;environnement:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>secret-env-pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>mycontainer<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>redis<span style="color:#bbb">
</span><span style="color:#bbb">    </span>env:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>SECRET_USERNAME<span style="color:#bbb">
</span><span style="color:#bbb">        </span>valueFrom:<span style="color:#bbb">
</span><span style="color:#bbb">          </span>secretKeyRef:<span style="color:#bbb">
</span><span style="color:#bbb">            </span>name:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb">            </span>key:<span style="color:#bbb"> </span>username<span style="color:#bbb">
</span><span style="color:#bbb">      </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>SECRET_PASSWORD<span style="color:#bbb">
</span><span style="color:#bbb">        </span>valueFrom:<span style="color:#bbb">
</span><span style="color:#bbb">          </span>secretKeyRef:<span style="color:#bbb">
</span><span style="color:#bbb">            </span>name:<span style="color:#bbb"> </span>mysecret<span style="color:#bbb">
</span><span style="color:#bbb">            </span>key:<span style="color:#bbb"> </span>password<span style="color:#bbb">
</span><span style="color:#bbb">  </span>restartPolicy:<span style="color:#bbb"> </span>Never</code></pre></div>
<h3 id="consommation-de-valeurs-secrètes-à-partir-de-variables-d-environnement">Consommation de valeurs secrètes à partir de variables d&rsquo;environnement</h3>

<p>À l&rsquo;intérieur d&rsquo;un conteneur qui consomme un secret dans des variables d&rsquo;environnement, les clés secrètes apparaissent comme des variables d&rsquo;environnement normales contenant les valeurs décodées en base64 des données secrètes.
C&rsquo;est le résultat des commandes exécutées à l&rsquo;intérieur du conteneur de l&rsquo;exemple ci-dessus:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#a2f">echo</span> <span style="color:#b8860b">$SECRET_USERNAME</span></code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">admin</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#a2f">echo</span> <span style="color:#b8860b">$SECRET_PASSWORD</span></code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">1f2d1e2e67df</code></pre></div>
<h3 id="utilisation-des-imagepullsecrets">Utilisation des imagePullSecrets</h3>

<p>Un <code>imagePullSecret</code> est un moyen de transmettre un secret qui contient un mot de passe de registre d&rsquo;images Docker (ou autre) au Kubelet afin qu&rsquo;il puisse extraire une image privée au nom de votre Pod.</p>

<h4 id="spécification-manuelle-d-une-imagepullsecret">Spécification manuelle d&rsquo;une imagePullSecret</h4>

<p>L&rsquo;utilisation de <code>imagePullSecrets</code> est décrite dans la <a href="/docs/concepts/containers/images/#specifying-imagepullsecrets-on-a-pod">documentation des images</a></p>

<h3 id="arranging-for-imagepullsecrets-to-be-automatically-attached">Arranging for imagePullSecrets to be Automatically Attached</h3>

<p>Vous pouvez créer manuellement un <code>imagePullSecret</code> et le référencer à partir d&rsquo;un <code>serviceAccount</code>.
Tous les pods créés avec ce <code>serviceAccount</code> ou cette valeur par défaut pour utiliser ce <code>serviceAccount</code>, verront leur champ <code>imagePullSecret</code> défini sur celui du compte de service.
Voir <a href="/docs/tasks/configure-pod-container/configure-service-account/#add-imagepullsecrets-to-a-service-account">Ajouter ImagePullSecrets à un compte de service</a> pour une explication détaillée de ce processus.</p>

<h3 id="montage-automatique-de-secrets-créés-manuellement">Montage automatique de secrets créés manuellement</h3>

<p>Les secrets créés manuellement (par exemple, un contenant un jeton pour accéder à un compte github) peuvent être automatiquement associés aux pods en fonction de leur compte de service.
Voir <a href="/docs/tasks/inject-data-application/podpreset/">Injection d&rsquo;informations dans des pods à l&rsquo;aide d&rsquo;un PodPreset</a> pour une explication détaillée de ce processus.</p>

<h2 id="details">Details</h2>

<h3 id="restrictions">Restrictions</h3>

<p>Les sources de volume secrètes sont validées pour garantir que la référence d&rsquo;objet spécifiée pointe réellement vers un objet de type Secret.
Par conséquent, un secret doit être créé avant tous les pods qui en dépendent.</p>

<p>Les objets API secrets résident dans un <a class='glossary-tooltip' href='/docs/concepts/overview/working-with-objects/namespaces' target='_blank'>namespace<span class='tooltip-text'>An abstraction used by Kubernetes to support multiple virtual clusters on the same physical cluster.</span>
</a>.
Ils ne peuvent être référencés que par des pods dans le même espace de noms.</p>

<p>Les secrets individuels sont limités à 1 Mo de taille.
C&rsquo;est pour décourager la création de très grands secrets qui épuiseraient la mémoire de l&rsquo;apiserver et du kubelet.
Cependant, la création de nombreux petits secrets pourrait également épuiser la mémoire.
Des limites plus complètes sur l&rsquo;utilisation de la mémoire en raison de secrets sont une fonctionnalité prévue.</p>

<p>Kubelet prend uniquement en charge l&rsquo;utilisation des secrets pour les pods qu&rsquo;il obtient du serveur API.
Cela inclut tous les pods créés à l&rsquo;aide de kubectl, ou indirectement via un contrôleur de réplication.
Il n&rsquo;inclut pas les pods créés via les drapeaux kubelet <code>--manifest-url</code>, ou <code>--config</code>, ou son API REST (ce ne sont pas des moyens courants de créer des Pods).</p>

<p>Les secrets doivent être créés avant d&rsquo;être consommés dans les pods en tant que variables d&rsquo;environnement, sauf s&rsquo;ils sont marqués comme facultatifs.
Les références à des secrets qui n&rsquo;existent pas empêcheront le pod de démarrer.</p>

<p>Les références via <code>secretKeyRef</code> à des clés qui n&rsquo;existent pas dans un Secret nommé empêcheront le pod de démarrer.</p>

<p>Les secrets utilisés pour remplir les variables d&rsquo;environnement via <code>envFrom</code> qui ont des clés considérées comme des noms de variables d&rsquo;environnement non valides verront ces clés ignorées.
Le pod sera autorisé à démarrer.
Il y aura un événement dont la raison est <code>InvalidVariableNames</code> et le message contiendra la liste des clés invalides qui ont été ignorées.
L&rsquo;exemple montre un pod qui fait référence au / mysecret par défaut qui contient 2 clés invalides, 1badkey et 2alsobad.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl get events</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">LASTSEEN   FIRSTSEEN   COUNT     NAME            KIND      SUBOBJECT                         TYPE      REASON
0s         0s          1         dapi-test-pod   Pod                                         Warning   InvalidEnvironmentVariableNames   kubelet, 127.0.0.1      Keys [1badkey, 2alsobad] from the EnvFrom secret default/mysecret were skipped since they are considered invalid environment variable names.</code></pre></div>
<h3 id="cycle-de-vie-de-l-intéraction-secret-et-pod">Cycle de vie de l&rsquo;intéraction Secret et Pod</h3>

<p>Lorsqu&rsquo;un pod est créé via l&rsquo;API, il n&rsquo;est pas vérifié s&rsquo;il existe un secret référencé.
Une fois qu&rsquo;un pod est programmé, le kubelet tentera de récupérer la valeur secrète.
Si le secret ne peut pas être récupéré parce qu&rsquo;il n&rsquo;existe pas ou en raison d&rsquo;un manque temporaire de connexion au serveur API, kubelet réessayera périodiquement.
Il rapportera un événement sur le pod expliquant la raison pour laquelle il n&rsquo;a pas encore démarré.
Une fois le secret récupéré, le kubelet créera et montera un volume le contenant.
Aucun des conteneurs du pod ne démarre tant que tous les volumes du pod ne sont pas montés.</p>

<h2 id="cas-d-utilisation">Cas d&rsquo;utilisation</h2>

<h3 id="cas-d-utilisation-pod-avec-clés-ssh">Cas d&rsquo;utilisation: pod avec clés SSH</h3>

<p>Créez un kustomization.yaml avec un <code>SecretGenerator</code> contenant quelques clés SSH:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create secret generic ssh-key-secret --from-file<span style="color:#666">=</span>ssh-privatekey<span style="color:#666">=</span>/path/to/.ssh/id_rsa --from-file<span style="color:#666">=</span>ssh-publickey<span style="color:#666">=</span>/path/to/.ssh/id_rsa.pub</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">secret &#34;ssh-key-secret&#34; created</code></pre></div>
<blockquote class="caution">
  <div><strong>Avertissement:</strong> Réfléchissez bien avant d&rsquo;envoyer vos propres clés SSH: d&rsquo;autres utilisateurs du cluster peuvent avoir accès au secret.
Utilisez un compte de service que vous souhaitez rendre accessible à tous les utilisateurs avec lesquels vous partagez le cluster Kubernetes et que vous pouvez révoquer s&rsquo;ils sont compromis.</div>
</blockquote>

<p>Nous pouvons maintenant créer un pod qui référence le secret avec la clé SSH et le consomme dans un volume:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>secret-test-pod<span style="color:#bbb">
</span><span style="color:#bbb">  </span>labels:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name:<span style="color:#bbb"> </span>secret-test<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>secret-volume<span style="color:#bbb">
</span><span style="color:#bbb">    </span>secret:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>secretName:<span style="color:#bbb"> </span>ssh-key-secret<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>ssh-test-container<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>mySshImage<span style="color:#bbb">
</span><span style="color:#bbb">    </span>volumeMounts:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>secret-volume<span style="color:#bbb">
</span><span style="color:#bbb">      </span>readOnly:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>mountPath:<span style="color:#bbb"> </span><span style="color:#b44">&#34;/etc/secret-volume&#34;</span></code></pre></div>
<p>Lorsque la commande du conteneur s&rsquo;exécute, les morceaux de la clé seront disponibles dans:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">/etc/secret-volume/ssh-publickey
/etc/secret-volume/ssh-privatekey</code></pre></div>
<p>Le conteneur est alors libre d&rsquo;utiliser les données secrètes pour établir une connexion SSH.</p>

<h3 id="cas-d-utilisation-pods-avec-informations-d-identification-de-prod-test">Cas d&rsquo;utilisation: pods avec informations d&rsquo;identification de prod/test</h3>

<p>Faites un fichier kustomization.yaml avec un SecretGenerator.</p>

<p>Cet exemple illustre un Pod qui consomme un secret contenant des informations d&rsquo;identification de prod et un autre Pod qui consomme un secret avec des informations d&rsquo;identification d&rsquo;environnement de test.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create secret generic prod-db-secret --from-literal<span style="color:#666">=</span><span style="color:#b8860b">username</span><span style="color:#666">=</span>produser --from-literal<span style="color:#666">=</span><span style="color:#b8860b">password</span><span style="color:#666">=</span>Y4nys7f11</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">secret &#34;prod-db-secret&#34; created</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create secret generic test-db-secret --from-literal<span style="color:#666">=</span><span style="color:#b8860b">username</span><span style="color:#666">=</span>testuser --from-literal<span style="color:#666">=</span><span style="color:#b8860b">password</span><span style="color:#666">=</span>iluvtests</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">secret &#34;test-db-secret&#34; created</code></pre></div>
<blockquote class="note">
  <div><strong>Note:</strong> <p>Caractères spéciaux tels que <code>$</code>, <code>\</code>, <code>*</code>, et <code>!</code> seront interprétés par votre <a href="https://en.wikipedia.org/wiki/Shell_(computing)" target="_blank">shell</a> et nécessitent d&rsquo;être échappés.
Dans les shells les plus courants, le moyen le plus simple d&rsquo;échapper au mot de passe est de l&rsquo;entourer de guillemets simples (<code>'</code>).
Par exemple, si votre mot de passe réel est <code>S!B\*d$zDsb</code>, vous devez exécuter la commande de cette façon:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">kubectl create secret generic dev-db-secret --from-literal=username=devuser --from-literal=password=&#39;S!B\*d$zDsb&#39;</code></pre></div>
<p>Vous n&rsquo;avez pas besoin d&rsquo;échapper les caractères spéciaux dans les mots de passe des fichiers (<code>--from-file</code>).</p>
</div>
</blockquote>

<p>Maintenant, faites les pods:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ cat <span style="color:#b44">&lt;&lt;EOF &gt; pod.yaml
</span><span style="color:#b44">apiVersion: v1
</span><span style="color:#b44">kind: List
</span><span style="color:#b44">items:
</span><span style="color:#b44">- kind: Pod
</span><span style="color:#b44">  apiVersion: v1
</span><span style="color:#b44">  metadata:
</span><span style="color:#b44">    name: prod-db-client-pod
</span><span style="color:#b44">    labels:
</span><span style="color:#b44">      name: prod-db-client
</span><span style="color:#b44">  spec:
</span><span style="color:#b44">    volumes:
</span><span style="color:#b44">    - name: secret-volume
</span><span style="color:#b44">      secret:
</span><span style="color:#b44">        secretName: prod-db-secret
</span><span style="color:#b44">    containers:
</span><span style="color:#b44">    - name: db-client-container
</span><span style="color:#b44">      image: myClientImage
</span><span style="color:#b44">      volumeMounts:
</span><span style="color:#b44">      - name: secret-volume
</span><span style="color:#b44">        readOnly: true
</span><span style="color:#b44">        mountPath: &#34;/etc/secret-volume&#34;
</span><span style="color:#b44">- kind: Pod
</span><span style="color:#b44">  apiVersion: v1
</span><span style="color:#b44">  metadata:
</span><span style="color:#b44">    name: test-db-client-pod
</span><span style="color:#b44">    labels:
</span><span style="color:#b44">      name: test-db-client
</span><span style="color:#b44">  spec:
</span><span style="color:#b44">    volumes:
</span><span style="color:#b44">    - name: secret-volume
</span><span style="color:#b44">      secret:
</span><span style="color:#b44">        secretName: test-db-secret
</span><span style="color:#b44">    containers:
</span><span style="color:#b44">    - name: db-client-container
</span><span style="color:#b44">      image: myClientImage
</span><span style="color:#b44">      volumeMounts:
</span><span style="color:#b44">      - name: secret-volume
</span><span style="color:#b44">        readOnly: true
</span><span style="color:#b44">        mountPath: &#34;/etc/secret-volume&#34;
</span><span style="color:#b44">EOF</span></code></pre></div>
<p>Ajoutez les pods à la même kustomization.yaml</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ cat <span style="color:#b44">&lt;&lt;EOF &gt;&gt; kustomization.yaml
</span><span style="color:#b44">resources:
</span><span style="color:#b44">- pod.yaml
</span><span style="color:#b44">EOF</span></code></pre></div>
<p>Appliquez tous ces objets sur l&rsquo;Apiserver avec</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl apply -k .</code></pre></div>
<p>Les deux conteneurs auront les fichiers suivants présents sur leurs systèmes de fichiers avec les valeurs pour l&rsquo;environnement de chaque conteneur:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">/etc/secret-volume/username
/etc/secret-volume/password</code></pre></div>
<p>Notez comment les spécifications pour les deux pods ne diffèrent que dans un champ; cela facilite la création de pods avec différentes capacités à partir d&rsquo;un template de pod commun.</p>

<p>Vous pouvez encore simplifier la spécification du pod de base en utilisant deux comptes de service: un appelé, disons, <code>prod-user</code> avec le secret <code>prod-db-secret</code>, et un appelé, <code>test-user</code> avec le secret <code>test-db-secret</code>.
Ensuite, la spécification du pod peut être raccourcie, par exemple:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>prod-db-client-pod<span style="color:#bbb">
</span><span style="color:#bbb">  </span>labels:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>name:<span style="color:#bbb"> </span>prod-db-client<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>serviceAccount:<span style="color:#bbb"> </span>prod-db-client<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>db-client-container<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>myClientImage</code></pre></div>
<h3 id="cas-d-utilisation-dotfiles-dans-un-volume-secret">Cas d&rsquo;utilisation: Dotfiles dans un volume secret</h3>

<p>Afin de masquer des données (c&rsquo;est-à-dire dans un fichier dont le nom commence par un point), il suffit de faire commencer cette clé par un point.
Par exemple, lorsque le secret suivant est monté dans un volume:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>dotfile-secret<span style="color:#bbb">
</span><span style="color:#bbb"></span>data:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>.secret-file:<span style="color:#bbb"> </span>dmFsdWUtMg0KDQo=<span style="color:#bbb">
</span><span style="color:#bbb"></span>---<span style="color:#bbb">
</span><span style="color:#bbb"></span>apiVersion:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb"></span>kind:<span style="color:#bbb"> </span>Pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>metadata:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>name:<span style="color:#bbb"> </span>secret-dotfiles-pod<span style="color:#bbb">
</span><span style="color:#bbb"></span>spec:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>volumes:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>secret-volume<span style="color:#bbb">
</span><span style="color:#bbb">    </span>secret:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>secretName:<span style="color:#bbb"> </span>dotfile-secret<span style="color:#bbb">
</span><span style="color:#bbb">  </span>containers:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>dotfile-test-container<span style="color:#bbb">
</span><span style="color:#bbb">    </span>image:<span style="color:#bbb"> </span>k8s.gcr.io/busybox<span style="color:#bbb">
</span><span style="color:#bbb">    </span>command:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>ls<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span><span style="color:#b44">&#34;-l&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span><span style="color:#b44">&#34;/etc/secret-volume&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span>volumeMounts:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>-<span style="color:#bbb"> </span>name:<span style="color:#bbb"> </span>secret-volume<span style="color:#bbb">
</span><span style="color:#bbb">      </span>readOnly:<span style="color:#bbb"> </span><span style="color:#a2f;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span>mountPath:<span style="color:#bbb"> </span><span style="color:#b44">&#34;/etc/secret-volume&#34;</span></code></pre></div>
<p>Le <code>secret-volume</code> contiendra un seul fichier, appelé <code>.secret-file</code>, et le <code>dotfile-test-container</code> aura ce fichier présent au chemin <code>/etc/secret-volume/.secret-file</code>.</p>

<blockquote class="note">
  <div><strong>Note:</strong> Les fichiers commençant par des points sont masqués de la sortie de <code>ls -l</code>; vous devez utiliser <code>ls -la</code> pour les voir lors de la liste du contenu du répertoire.</div>
</blockquote>

<h3 id="cas-d-utilisation-secret-visible-pour-un-conteneur-dans-un-pod">Cas d&rsquo;utilisation: secret visible pour un conteneur dans un pod</h3>

<p>Envisagez un programme qui doit gérer les requêtes HTTP, effectuer une logique métier complexe, puis signer certains messages avec un HMAC.
Parce qu&rsquo;il a une logique d&rsquo;application complexe, il pourrait y avoir un exploit de lecture de fichier à distance inaperçu dans le serveur, qui pourrait exposer la clé privée à un attaquant.</p>

<p>Cela pourrait être divisé en deux processus dans deux conteneurs: un conteneur frontal qui gère l&rsquo;interaction utilisateur et la logique métier, mais qui ne peut pas voir la clé privée; et un conteneur de signataire qui peut voir la clé privée, et répond aux demandes de signature simples du frontend (par exemple sur le réseau localhost).</p>

<p>Avec cette approche partitionnée, un attaquant doit maintenant inciter le serveur d&rsquo;applications à faire quelque chose d&rsquo;assez arbitraire, ce qui peut être plus difficile que de lui faire lire un fichier.</p>

<!-- TODO: explain how to do this while still using automation. -->

<h2 id="les-meilleures-pratiques">Les meilleures pratiques</h2>

<h3 id="clients-qui-utilisent-l-api-secrets">Clients qui utilisent l&rsquo;API secrets</h3>

<p>Lors du déploiement d&rsquo;applications qui interagissent avec l&rsquo;API secrets, l&rsquo;accès doit être limité à l&rsquo;aide de <a href="/docs/reference/access-authn-authz/authorization/">politiques d&rsquo;autorisation</a> telles que <a href="/docs/reference/access-authn-authz/rbac/">RBAC</a>.</p>

<p>Les secrets contiennent souvent des valeurs qui couvrent un spectre d&rsquo;importance, dont beaucoup peuvent provoquer des escalades au sein de Kubernetes (par exemple, les jetons de compte de service) et vers les systèmes externes.
Même si une application individuelle peut raisonner sur la puissance des secrets avec lesquels elle s&rsquo;attend à interagir, d&rsquo;autres applications dans le même namespace peuvent rendre ces hypothèses invalides.</p>

<p>Pour ces raisons, les requêtes <code>watch</code> et <code>list</code> pour les secrets dans un namespace sont des capacités extrêmement puissantes et doivent être évitées, puisque la liste des secrets permet aux clients d&rsquo;inspecter les valeurs de tous les secrets qui se trouvent dans ce namespace.
La capacité à effectuer un <code>watch</code> ou <code>list</code> des secrets dans un cluster doit être réservé uniquement aux composants les plus privilégiés au niveau du système.</p>

<p>Les applications qui ont besoin d&rsquo;accéder à l&rsquo;API secrets doivent effectuer des requêtes <code>get</code> sur les secrets dont elles ont besoin.
Cela permet aux administrateurs de restreindre l&rsquo;accès à tous les secrets tout en donnant <a href="/docs/reference/access-authn-authz/rbac/#referring-to-resources">accès en liste blanche aux instances individuelles</a> dont l&rsquo;application a besoin.</p>

<p>Pour des performances améliorées sur une boucle <code>get</code>, les clients peuvent concevoir des ressources qui font référence à un secret puis <code>watch</code> la ressource, demandant à nouveau le secret lorsque la ressource change.
De plus, un <a href="https://github.com/kubernetes/community/blob/master/contributors/design-proposals/api-machinery/bulk_watch.md" target="_blank">&ldquo;bulk watch&rdquo; API</a> laisse les clients <code>watch</code> des ressources individuelles ont également été proposées et seront probablement disponibles dans les prochaines versions de Kubernetes.</p>

<h2 id="propriétés-de-sécurité">Propriétés de sécurité</h2>

<h3 id="protections">Protections</h3>

<p>Étant donné que les objets secrets peuvent être créés indépendamment des Pods qui les utilisent, il y a moins de risques que le secret soit exposé pendant la création, la visualisation et la modification des Pods.
Le système peut également prendre des précautions supplémentaires avec les objets secrets, comme éviter de les écrire sur le disque lorsque cela est possible.</p>

<p>Un secret n&rsquo;est envoyé à un nœud que si un module sur ce nœud l&rsquo;exige.
Kubelet stocke le secret dans un <code>tmpfs</code> afin que le secret ne soit pas écrit sur le stockage sur disque.
Une fois que le pod qui dépend du secret est supprimé, kubelet supprimera également sa copie locale des données secrètes.</p>

<p>Il peut y avoir des secrets pour plusieurs pods sur le même nœud.
Cependant, seuls les secrets qu&rsquo;un pod demande sont potentiellement visibles dans ses conteneurs.
Par conséquent, un pod n&rsquo;a pas accès aux secrets d&rsquo;un autre pod.</p>

<p>Il peut y avoir plusieurs conteneurs dans un pod.
Cependant, chaque conteneur d&rsquo;un pod doit demander le volume secret dans ses <code>volumesMounts</code> pour qu&rsquo;il soit visible dans le conteneur.
Cela peut être utilisé pour construire des <a href="#use-case-secret-visible-to-one-container-in-a-pod">partitions de sécurité au niveau du pod</a>.</p>

<p>Sur la plupart des distributions gérées par le projet Kubernetes, la communication entre l&rsquo;utilisateur vers l&rsquo;apiserver et entre l&rsquo;apiserver et les kubelets est protégée par SSL/TLS.
Les secrets sont protégés lorsqu&rsquo;ils sont transmis sur ces canaux.</p>

<div style="margin-top: 10px; margin-bottom: 10px;">



<b>FEATURE STATE:</b> <code>Kubernetes v1.13</code>




    
    
    
    
    
<a href="#" id="feature-state-dialog-link" class="ui-state-default ui-corner-all"><span class="ui-icon ui-icon-newwin"></span>beta</a>
<div id="feature-state-dialog" class="ui-dialog-content" title="beta">
Cette fonctionnalité est actuellement dans un état <em>beta</em>, c&rsquo;est-à-dire :</p>

<ul>
<li>Les noms de version contiennent: beta (par ex. v2beta3).</li>
<li>Le code est bien testé. L&rsquo;activation de cette fonctionnalité est considérée comme sûre. Elle est activée par défaut.</li>
<li>La prise en charge de l&rsquo;ensemble de la fonctionnalité ne sera pas supprimée, bien que des détails puissent changer.</li>
<li>Le schéma et/ou la sémantique des objets peuvent changer de manière incompatible dans une version bêta ou stable ultérieure. Lorsque cela se produira, nous vous fournirons des instructions pour migrer vers la prochaine version. Cela peut nécessiter la suppression, l&rsquo;édition et la recréation d&rsquo;objets API. Le processus de changement de version peut nécessiter une certaine réflexion. Cela peut aussi nécessiter une interruption de service pour les applications qui s&rsquo;appuient sur cette fonctionnalité.</li>
<li>Recommandé uniquement pour les utilisations non critiques en raison du risque de changements incompatibles dans les versions ultérieures. Si vous avez plusieurs clusters qui peuvent être mis à niveau indépendamment, vous pouvez assouplir cette restriction.</li>
<li>Donnez votre avis sur cette fonctionnalité bêta ! Une fois qu&rsquo;elle aura quitté la version bêta, ce sera probablement moins évident pour nous d&rsquo;apporter d&rsquo;autres changements.</li>
</ul>
</div>
<script>
$(function(){
    
    $( "#feature-state-dialog" ).dialog({
        autoOpen: false,
        width: "600",
        buttons: [
            {
                text: "Ok",
                click: function() {
                    $( this ).dialog( "close" );
                }
            }
        ]
    });

    
    $( "#feature-state-dialog-link" ).click(function( event ) {
        $( "#feature-state-dialog" ).dialog( "open" );
        event.preventDefault();
    });

});
</script>

    

</div>

<p>Vous pouvez activer le <a href="/docs/tasks/administer-cluster/encrypt-data/">chiffrement au repos</a> pour les données secrètes, afin que les secrets ne soient pas stockés en clair dans <a class='glossary-tooltip' href='/docs/tasks/administer-cluster/configure-upgrade-etcd/' target='_blank'>etcd<span class='tooltip-text'>Base de données clé-valeur consistante et hautement disponible utilisée comme mémoire de sauvegarde pour toutes les données du cluster.</span>
</a>.</p>

<h3 id="risques">Risques</h3>

<ul>
<li>Dans le serveur API, les données secrètes sont stockées dans <a class='glossary-tooltip' href='/docs/tasks/administer-cluster/configure-upgrade-etcd/' target='_blank'>etcd<span class='tooltip-text'>Base de données clé-valeur consistante et hautement disponible utilisée comme mémoire de sauvegarde pour toutes les données du cluster.</span>
</a>; par conséquent:

<ul>
<li>Les administrateurs doivent activer le chiffrement au repos pour les données du cluster (nécessite la version 1.13 ou ultérieure)</li>
<li>Les administrateurs devraient limiter l&rsquo;accès à etcd aux utilisateurs administrateurs</li>
<li>Les administrateurs peuvent vouloir effacer/détruire les disques utilisés par etcd lorsqu&rsquo;ils ne sont plus utilisés</li>
<li>Si vous exécutez etcd dans un cluster, les administrateurs doivent s&rsquo;assurer d&rsquo;utiliser SSL/TLS pour la communication peer-to-peer etcd.</li>
</ul></li>
<li>Si vous configurez le secret via un fichier manifeste (JSON ou YAML) qui a les données secrètes codées en base64, partager ce fichier ou l&rsquo;archiver dans un dépot de source signifie que le secret est compromis.
L&rsquo;encodage Base64 <em>n&rsquo;est pas</em> une méthode de chiffrement, il est considéré comme identique au texte brut.</li>
<li>Les applications doivent toujours protéger la valeur du secret après l&rsquo;avoir lu dans le volume, comme ne pas le mettre accidentellement dans un journal ou le transmettre à une partie non fiable.</li>
<li>Un utilisateur qui peut créer un pod qui utilise un secret peut également voir la valeur de ce secret.
Même si la stratégie apiserver ne permet pas à cet utilisateur de lire l&rsquo;objet secret, l&rsquo;utilisateur peut créer un pod qui expose le secret.</li>
<li>Actuellement, toute personne disposant des droit root sur n&rsquo;importe quel nœud peut lire <em>n&rsquo;importe quel</em> secret depuis l&rsquo;apiserver, en usurpant l&rsquo;identité du kubelet.
Il est prévu de n&rsquo;envoyer des secrets qu&rsquo;aux nœuds qui en ont réellement besoin, pour limiter l&rsquo;impact d&rsquo;un exploit root sur un seul nœud.</li>
</ul>














    
    

    
            
  <h2>Feedback</h2>
  <p class="feedback--prompt">Cette page est elle utile ? </p>
  <button class="button feedback--yes">Oui</button>
  <button class="button feedback--no">Non</button>
  <p class="feedback--response feedback--response__hidden">
    Thanks for the feedback. If you have a specific, answerable question about how to use Kubernetes, ask it on
    <a target="_blank" rel="noopener"
      href="https://stackoverflow.com/questions/tagged/kubernetes">
      Stack Overflow</a>.
    Open an issue in the GitHub repo if you want to 
    <a class="feedback--link" target="_blank" rel="noopener"
      href="https://github.com/kubernetes/website/issues/new?title=Issue%20with%20k8s.io">
      report a problem</a>
    or
    <a class="feedback--link" target="_blank" rel="noopener"
      href="https://github.com/kubernetes/website/issues/new?title=Improvement%20for%20k8s.io">
      suggest an improvement</a>.
  </p>
  <script>
    const yes = document.querySelector('.feedback--yes');
    const no = document.querySelector('.feedback--no');
    document.querySelectorAll('.feedback--link').forEach(link => {
      link.href = link.href + window.location.pathname;
    });
    const sendFeedback = (value) => {
      if (!gtag) { console.log('!gtag'); }
      gtag('event', 'click', {
        'event_category': 'Helpful',
        'event_label': window.location.pathname,
        value
      });
    };
    const disableButtons = () => {
      yes.disabled = true;
      yes.classList.add('feedback--button__disabled');
      no.disabled = true;
      no.classList.add('feedback--button__disabled');
    };
    yes.addEventListener('click', () => {
      sendFeedback(1);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
    no.addEventListener('click', () => {
      sendFeedback(0);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
  </script>


    
            <div id="pre-footer"> 
  <hr />

  <div class="issue-button-container">
    <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/concepts/configuration/_index.md?pixel" alt="Analytics" /></a></p>
    
    
    <script type="text/javascript">
    PDRTJS_settings_8345992 = {
    "id" : "8345992",
    "unique_id" : "\/fr\/docs\/concepts\/configuration\/",
    "title" : "Configuration",
    "permalink" : "https:\/\/kubernetes.io\/fr\/docs\/concepts\/configuration\/"
    };
    (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
    </script>
    <a href="" onclick="window.open('https://github.com/kubernetes/website/issues/new?template=bug-report.md&title=Issue%20with%20' +
    'k8s.io'+window.location.pathname)" class="button issue">Ouvrez un ticket</a>
    
    
    
    <a href="https://github.com/kubernetes/website/edit/master/content/fr/docs/concepts/configuration/_index.md" class="button issue">Editez cette page</a>
    
  </div>
  

  <div id="lastedit" class="lastedit issue-button-container">
    Dernière modification le June 11, 2019 at 7:06 PM PST de
    <a href="https://github.com/kubernetes/website/commit/d028d87b8e86829d16d7cb34c8d652cd8de1c28c/">Add all the _index files for the French translation (#14744)</a> (<a href="https://github.com/kubernetes/website/commits/master/content/en/docs/concepts/configuration/_index.md">Historique</a>)
  </div>
  
</div>

          </div>
        </section>
    </main>
		<footer>
    <div class="light-text main-section">
        <nav>
            
            
            
            <a href="/fr/docs/home/">Accueil</a>
            
            <a href="/fr/blog/">Blog</a>
            
            
            
            <a href="/fr/partners/">Partenaires</a>
            
            <a href="/fr/community/">Communauté</a>
            
            <a href="/fr/case-studies/">Études de cas</a>
            
        </nav>
        <div class="social" role="region" aria-label="Social hyperlinks">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="https://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://www.youtube.com/kubernetescommunity" class="youtube"><span>YouTube</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>Forum</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Calendrier</span></a>
            </div>
            <div>
                
                <a href="https://git.k8s.io/community/contributors/guide" class="button">Contribuer</a>
            </div>
        </div>
        <div class="miceType center">
            &copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a></a>
        </div>
        <div class="miceType center">
            Copyright &copy; 2023 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
        <div class="miceType center">
            ICP license: 京ICP备17074266号-3
        </div>
    </div>
</footer>

		<button class="flyout-button" onclick="kub.toggleToc()" aria-label="Toggle table of contents visibility"></button>

<script>

(function () {
    window.addEventListener('DOMContentLoaded', init)

        
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>



    <script language="application/javascript">
      
      (function addHeadingLinks(){
        var article = document.getElementById('docsContent');
        var headings = article.querySelectorAll('h1, h2, h3, h4, h5, h6');
        headings.forEach(function(heading){
          if(heading.id){
            var a = document.createElement('a');
            a.innerHTML = heading.innerHTML;
            a.href = '#'+heading.id;
            a.classList.add('inpage_heading');
            heading.innerHTML = '';
            heading.appendChild(a);
          }
        });
      })();
    </script>
	</body>
</html>
