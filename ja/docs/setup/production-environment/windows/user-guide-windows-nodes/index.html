<!DOCTYPE html>
<html id="docs" lang="ja" class="">
	<head>
	

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36037335-10"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-36037335-10');
</script>
<meta charset="utf-8">
<title>Guide for adding Windows Nodes in Kubernetes - Kubernetes</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#326ce5">
<link rel="shortcut icon" type="image/png" href="/images/favicon.png">









<link rel="stylesheet" href="/css/style.b7b8403eb5b1fddd0a2da2a8383d5b53e6ef81c23e4b0e292e6103bd91f9502d.css" integrity="sha256-t7hAPrWx/d0KLaKoOD1bU&#43;bvgcI&#43;Sw4pLmEDvZH5UC0=">


<link rel="stylesheet" href="/css/base_fonts.css">
<link rel="stylesheet" href="/css/jquery-ui.min.css">
<link rel="stylesheet" href="/css/callouts.css">
<link rel="stylesheet" href="/css/custom-jekyll/tags.css">



<meta name="description" content="">
<meta property="og:description" content="">
<meta name="twitter:description" content="">
<meta property="og:url" content="https://kubernetes.io/ja/docs/setup/production-environment/windows/user-guide-windows-nodes/">
<meta property="og:title" content="Guide for adding Windows Nodes in Kubernetes">
<meta name="twitter:title" content="Guide for adding Windows Nodes in Kubernetes">
<meta name="twitter:image" content="https://kubernetes.io/images/favicon.png" />

<meta name="twitter:image:alt" content="Kubernetes">

<meta property="og:image" content="/images/kubernetes-horizontal-color.png">

<meta property="og:type" content="article">
<script src="/js/anchor-4.1.1.min.js"></script>
<script src="/js/jquery-3.2.1.min.js"></script>
<script src="/js/jquery-ui-1.12.1.min.js"></script>
<script src="/js/bootstrap-4.3.1.min.js"></script>
<script src="/js/sweetalert-2.1.2.min.js"></script>

<script src="/js/script.js"></script>
<script src="/js/custom-jekyll/tags.js"></script>


	</head>
	<body>
		<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/ja/" class="logo" title="プロダクショングレードのコンテナ管理基盤 - Kubernetes" aria-label="Kubernetes website"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            
            
            <li><a href="/ja/docs/" class="active">ドキュメント</a></li>
            
            
            
            
            
            
            
            
            
            <li><a href="/ja/case-studies/">ケーススタディ</a></li>
            
            
            
             <li>
                <a href="#">
                    日本語 Japanese <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="/docs/setup/production-environment/windows/user-guide-windows-nodes/">English</a></li>
                
                    <li><a href="/ko/docs/setup/production-environment/windows/user-guide-windows-nodes/">한국어 Korean</a></li>
                
                </ul>
            </li>

            <li>
                <a href="#">
                    v1.17 <span class="ui-icon ui-icon-carat-1-s"></span>
                </a>
                <ul>
                
                    <li><a href="https://kubernetes.io/ja/docs/setup/production-environment/windows/user-guide-windows-nodes/">v1.21</a></li>
                
                    <li><a href="https://v1-20.docs.kubernetes.io/ja/docs/setup/production-environment/windows/user-guide-windows-nodes/">v1.20</a></li>
                
                    <li><a href="https://v1-19.docs.kubernetes.io/ja/docs/setup/production-environment/windows/user-guide-windows-nodes/">v1.19</a></li>
                
                    <li><a href="https://v1-18.docs.kubernetes.io/ja/docs/setup/production-environment/windows/user-guide-windows-nodes/">v1.18</a></li>
                
                    <li><a href="https://v1-17.docs.kubernetes.io/ja/docs/setup/production-environment/windows/user-guide-windows-nodes/">v1.17</a></li>
                
                </ul>
            </li>
        </ul>
        
        <a href="/ja/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>Kubernetesの基本を学ぶ</a>
        

        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <div class="main-section" data-auto-burger="primary">
         
           <div class="nav-box">
            <h3><a href="/ja/docs/tutorials/hello-minikube/">Get Started</a></h3>
           <p>手を動かす準備はできていますか？本チュートリアルでは、Node.jsを使った簡単な"Hello World"を実行するKubernetesクラスタをビルドします。</p>

            </div>
         
           <div class="nav-box">
            <h3><a href="/ja/docs/home/">ドキュメント</a></h3>
           <p>チュートリアル、サンプルやドキュメントのリファレンスを使って Kubernetes の利用方法を学んでください。あなたは<a href="/editdocs/" data-auto-burger-exclude>ドキュメントへコントリビュートをする</a>こともできます!</p>

            </div>
         
        </div>
        <div class="main-section" data-auto-burger="primary">
            <div class="left">
                <h5 class="github-invite">Kubernetesのコードを編集することに興味がありますか？</h5>
                <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>GitHubで参照する</a>
            </div>

            <div class="right">
                <h5 class="github-invite">コミュニティを探す</h5>
                <div class="social">
                    <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                    <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                    <a href="http://slack.k8s.io/" class="slack"><span>Slack Slack</span></a>
                    <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                    <a href="https://www.youtube.com/kubernetescommunity" class="youtube"><span>YouTube</span></a>
                    <a href="https://discuss.kubernetes.io" class="mailing-list"><span>フォーラム</span></a>
                    <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>イベントカレンダー</span></a>
                </div>
            </div>
            <div class="clear" style="clear: both"></div>
        </div>
    </nav>
</header>

		
		
		<section id="hero" class="light-text no-sub">
			







<h1>はじめに</h1>
<h5></h5>












<div id="vendorStrip" class="light-text">
	<ul>
		
		
		<li><a href="/ja/docs/home/">ホーム</a></li>
		
		
		<li><a href="/ja/docs/setup/" class="YAH">はじめに</a></li>
		
		
		<li><a href="/ja/docs/concepts/">コンセプト</a></li>
		
		
		<li><a href="/ja/docs/tasks/">タスク</a></li>
		
		
		<li><a href="/ja/docs/tutorials/">チュートリアル</a></li>
		
		
		<li><a href="/ja/docs/reference/">リファレンス</a></li>
		
		
		<li><a href="/ja/docs/contribute/">貢献</a></li>
		
	</ul>
	<form id="searchBox" action="/docs/search/" role="search">
		<input type="text" id="search" name="q" placeholder="検索" aria-label="Search">
	</form>
</div>

		</section>
		
    
		
<section id="deprecationWarning">
  <main>
    <div class="content deprecation-warning">
      <h3>
	 Kubernetes v1.17
	  のドキュメントは積極的にメンテナンスされていません。現在表示されているバージョンはスナップショットです。最新のドキュメントはこちらです: 
	 <a href="https://kubernetes.io/docs/home/">最新バージョン</a>
      </h3>
    </div>
  </main>
</section>


    <main>
        <section id="encyclopedia">
          
<div id="docsToc">
     <div class="pi-accordion">
    	
        
        
        
        
        
         
             
                 
             
         
             
                 
                          
                          
                 
             
         
             
         
             
         
             
         
             
         
             
         
         
        
        <a class="item" data-title="はじめに" href="/ja/docs/setup/"></a>

	
	
			
			
			
			
			
		
	
	
	
		
			
<div class="item" data-title="リリースノート及びバージョンスキュー">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="v1.17 Release Notes <small>(EN)</small>" href="/docs/setup/release/notes/"></a>

		
	
		
			

<a class="item" data-title="Kubernetesバージョンとバージョンスキューサポートポリシー" href="/ja/docs/setup/release/version-skew-policy/"></a>

		
	
		
			

<a class="item" data-title="リリースのビルド" href="/ja/docs/setup/release/building-from-source/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="環境について学ぶ">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" target="_blank" data-title="Installing Kubernetes with Kind <small>(EN)</small>" href="/docs/setup/learning-environment/kind/"></a>

		
	
		
			

<a class="item" data-title="Minikubeを使用してローカル環境でKubernetesを動かす" href="/ja/docs/setup/learning-environment/minikube/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="プロダクション環境">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="CRIのインストール" href="/ja/docs/setup/production-environment/container-runtimes/"></a>

		
	
		
			
<div class="item" data-title="Kubernetesをデプロイツールでインストールする">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			
<div class="item" data-title="kubeadmを使ってクラスターを構築する">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="kubeadmのインストール" href="/ja/docs/setup/production-environment/tools/kubeadm/install-kubeadm/"></a>

		
	
		
			

<a class="item" data-title="kubeadmを使用したシングルコントロールプレーンクラスターの作成" href="/ja/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/"></a>

		
	
		
			

<a class="item" data-title="kubeadmを使ったコントロールプレーンの設定のカスタマイズ" href="/ja/docs/setup/production-environment/tools/kubeadm/control-plane-flags/"></a>

		
	
		
			

<a class="item" data-title="Options for Highly Available topology" href="/ja/docs/setup/production-environment/tools/kubeadm/ha-topology/"></a>

		
	
		
			

<a class="item" data-title="kubeadmを使用した高可用性クラスターの作成" href="/ja/docs/setup/production-environment/tools/kubeadm/high-availability/"></a>

		
	
		
			

<a class="item" data-title="kubeadmを使用した高可用性etcdクラスターの作成" href="/ja/docs/setup/production-environment/tools/kubeadm/setup-ha-etcd-with-kubeadm/"></a>

		
	
		
			

<a class="item" data-title="kubeadmを使用したクラスター内の各kubeletの設定" href="/ja/docs/setup/production-environment/tools/kubeadm/kubelet-integration/"></a>

		
	
		
			

<a class="item" data-title="kubeadmのトラブルシューティング" href="/ja/docs/setup/production-environment/tools/kubeadm/troubleshooting-kubeadm/"></a>

		
	
		
			

<a class="item" data-title="Configuring your kubernetes cluster to self-host the control plane" href="/ja/docs/setup/production-environment/tools/kubeadm/self-hosting/"></a>

		
	

	</div>
</div>

		
	
		
			

<a class="item" data-title="kopsを使ったAWS上でのKubernetesのインストール" href="/ja/docs/setup/production-environment/tools/kops/"></a>

		
	
		
			

<a class="item" data-title="KRIBを使用してDigital Rebar Provision (DRP)と共にKubernetesをインストールする" href="/ja/docs/setup/production-environment/tools/krib/"></a>

		
	
		
			

<a class="item" data-title="kubesprayを使ったオンプレミス/クラウドプロバイダへのKubernetesのインストール" href="/ja/docs/setup/production-environment/tools/kubespray/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="ターンキークラウドソリューション">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Alibaba CloudでKubernetesを動かす" href="/ja/docs/setup/production-environment/turnkey/alibaba-cloud/"></a>

		
	
		
			

<a class="item" data-title="AWS EC2上でKubernetesを動かす" href="/ja/docs/setup/production-environment/turnkey/aws/"></a>

		
	
		
			

<a class="item" data-title="Azure 上で Kubernetes を動かす" href="/ja/docs/setup/production-environment/turnkey/azure/"></a>

		
	
		
			

<a class="item" data-title="CenturyLink Cloud上でKubernetesを動かす" href="/ja/docs/setup/production-environment/turnkey/clc/"></a>

		
	
		
			

<a class="item" data-title="Google Compute Engine上でKubernetesを動かす" href="/ja/docs/setup/production-environment/turnkey/gce/"></a>

		
	
		
			

<a class="item" data-title="IBM Cloud Privateを使ってマルチクラウドでKubernetesを動かす" href="/ja/docs/setup/production-environment/turnkey/icp/"></a>

		
	
		
			

<a class="item" target="_blank" data-title="Running Kubernetes on Tencent Kubernetes Engine <small>(EN)</small>" href="/docs/setup/production-environment/turnkey/tencent/"></a>

		
	
		
			

<a class="item" data-title="Stackpoint.ioを利用して複数のクラウド上でKubernetesを動かす" href="/ja/docs/setup/production-environment/turnkey/stackpoint/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Windows in Kubernetes">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Intro to Windows support in Kubernetes" href="/ja/docs/setup/production-environment/windows/intro-windows-in-kubernetes/"></a>

		
	
		
			

<a class="item" data-title="Guide for adding Windows Nodes in Kubernetes" href="/ja/docs/setup/production-environment/windows/user-guide-windows-nodes/"></a>

		
	
		
			

<a class="item" data-title="Guide for scheduling Windows containers in Kubernetes" href="/ja/docs/setup/production-environment/windows/user-guide-windows-containers/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="オンプレミスVM">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="Cloudstack" href="/ja/docs/setup/production-environment/on-premises-vm/cloudstack/"></a>

		
	
		
			

<a class="item" data-title="DC/OS上のKubernetes" href="/ja/docs/setup/production-environment/on-premises-vm/dcos/"></a>

		
	
		
			

<a class="item" data-title="oVirt" href="/ja/docs/setup/production-environment/on-premises-vm/ovirt/"></a>

		
	

	</div>
</div>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="ベストプラクティス">
	<div class="container">
		
		
	
	
			
			
			
			
			
		
	
	
	
		
			

<a class="item" data-title="複数のゾーンで動かす" href="/ja/docs/setup/best-practices/multiple-zones/"></a>

		
	
		
			

<a class="item" data-title="大規模クラスタの構築" href="/ja/docs/setup/best-practices/cluster-large/"></a>

		
	
		
			

<a class="item" data-title="ノードのセットアップの検証" href="/ja/docs/setup/best-practices/node-conformance/"></a>

		
	
		
			

<a class="item" data-title="PKI証明書とその要件" href="/ja/docs/setup/best-practices/certificates/"></a>

		
	

	</div>
</div>

		
	





     </div> 
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
</div> 


          <div id="docsContent">
            

<p>
  <a href="https://github.com/kubernetes/website/edit/master/content/ja/docs/setup/production-environment/windows/user-guide-windows-nodes.md" id="editPageButton" target="_blank">
    Edit This Page
  </a>
</p>

<h1>Guide for adding Windows Nodes in Kubernetes</h1>



<p>The Kubernetes platform can now be used to run both Linux and Windows containers. One or more Windows nodes can be registered to a cluster. This guide shows how to:</p>

<ul>
<li>Register a Windows node to the cluster</li>
<li>Configure networking so pods on Linux and Windows can communicate</li>
</ul>









<ul id="markdown-toc">










<li><a href="#before-you-begin">Before you begin</a></li>




<li><a href="#getting-started-adding-a-windows-node-to-your-cluster">Getting Started: Adding a Windows Node to Your Cluster</a></li>



















</ul>


<h2 id="before-you-begin">Before you begin</h2>

<ul>
<li><p>Obtain a <a href="https://www.microsoft.com/en-us/cloud-platform/windows-server-pricing" target="_blank">Windows Server license</a> in order to configure the Windows node that hosts Windows containers. You can use your organization&rsquo;s licenses for the cluster, or acquire one from Microsoft, a reseller, or via the major cloud providers such as GCP, AWS, and Azure by provisioning a virtual machine running Windows Server through their marketplaces. A <a href="https://www.microsoft.com/en-us/cloud-platform/windows-server-trial" target="_blank">time-limited trial</a> is also available.</p></li>

<li><p>Build a Linux-based Kubernetes cluster in which you have access to the control plane (some examples include <a href="/ja/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/">Creating a single control-plane cluster with kubeadm</a>, <a href="/ja/docs/setup/production-environment/turnkey/azure/">AKS Engine</a>, <a href="/ja/docs/setup/production-environment/turnkey/gce/">GCE</a>, <a href="/ja/docs/setup/production-environment/turnkey/aws/">AWS</a>.</p></li>
</ul>

<h2 id="getting-started-adding-a-windows-node-to-your-cluster">Getting Started: Adding a Windows Node to Your Cluster</h2>

<h3 id="plan-ip-addressing">Plan IP Addressing</h3>

<p>Kubernetes cluster management requires careful planning of your IP addresses so that you do not inadvertently cause network collision. This guide assumes that you are familiar with the <a href="/docs/concepts/cluster-administration/networking/">Kubernetes networking concepts</a>.</p>

<p>In order to deploy your cluster you need the following address spaces:</p>

<table>
<thead>
<tr>
<th>Subnet / address range</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>

<tbody>
<tr>
<td>Service Subnet</td>
<td>A non-routable, purely virtual subnet that is used by pods to uniformly access services without caring about the network topology. It is translated to/from routable address space by <code>kube-proxy</code> running on the nodes.</td>
<td>10.96.0.0/12</td>
</tr>

<tr>
<td>Cluster Subnet</td>
<td>This is a global subnet that is used by all pods in the cluster. Each node is assigned a smaller /24 subnet from this for their pods to use. It must be large enough to accommodate all pods used in your cluster. To calculate <em>minimumsubnet</em> size: <code>(number of nodes) + (number of nodes * maximum pods per node that you configure)</code>. Example: for a 5 node cluster for 100 pods per node: <code>(5) + (5 * 100) = 505.</code></td>
<td>10.244.0.0/16</td>
</tr>

<tr>
<td>Kubernetes DNS Service IP</td>
<td>IP address of <code>kube-dns</code> service that is used for DNS resolution &amp; cluster service discovery.</td>
<td>10.96.0.10</td>
</tr>
</tbody>
</table>

<p>Review the networking options supported in &lsquo;Intro to Windows containers in Kubernetes: Supported Functionality: Networking&rsquo; to determine how you need to allocate IP addresses for your cluster.</p>

<h3 id="components-that-run-on-windows">Components that run on Windows</h3>

<p>While the Kubernetes control plane runs on your Linux node(s), the following components are configured and run on your Windows node(s).</p>

<ol>
<li>kubelet</li>
<li>kube-proxy</li>
<li>kubectl (optional)</li>
<li>Container runtime</li>
</ol>

<p>Get the latest binaries from <a href="https://github.com/kubernetes/kubernetes/releases" target="_blank">https://github.com/kubernetes/kubernetes/releases</a>, starting with v1.14 or later. The Windows-amd64 binaries for kubeadm, kubectl, kubelet, and kube-proxy can be found under the CHANGELOG link.</p>

<h3 id="networking-configuration">Networking Configuration</h3>

<p>Once you have a Linux-based Kubernetes master node you are ready to choose a networking solution. This guide illustrates using Flannel in VXLAN mode for simplicity.</p>

<h4 id="configuring-flannel-in-vxlan-mode-on-the-linux-controller">Configuring Flannel in VXLAN mode on the Linux controller</h4>

<ol>
<li><p>Prepare Kubernetes master for Flannel</p>

<p>Some minor preparation is recommended on the Kubernetes master in our cluster. It is recommended to enable bridged IPv4 traffic to iptables chains when using Flannel. This can be done using the following command:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo sysctl net.bridge.bridge-nf-call-iptables<span style="color:#666">=</span><span style="color:#666">1</span></code></pre></div></li>

<li><p>Download &amp; configure Flannel</p>

<p>Download the most recent Flannel manifest:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">wget https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</code></pre></div>
<p>There are two sections you should modify to enable the vxlan networking backend:</p>

<p>After applying the steps below, the <code>net-conf.json</code> section of <code>kube-flannel.yml</code> should look as follows:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="">net-conf.json:</span> <span style="">|</span>
    {
      <span style="color:#008000;font-weight:bold">&#34;Network&#34;</span>: <span style="color:#b44">&#34;10.244.0.0/16&#34;</span>,
      <span style="color:#008000;font-weight:bold">&#34;Backend&#34;</span>: {
        <span style="color:#008000;font-weight:bold">&#34;Type&#34;</span>: <span style="color:#b44">&#34;vxlan&#34;</span>,
        <span style="color:#008000;font-weight:bold">&#34;VNI&#34;</span> : <span style="color:#666">4096</span>,
        <span style="color:#008000;font-weight:bold">&#34;Port&#34;</span>: <span style="color:#666">4789</span>
      }
    }</code></pre></div>
<blockquote class="note">
<div><strong>備考:</strong> The VNI must be set to 4096 and port 4789 for Flannel on Linux to interoperate with Flannel on Windows. Support for other VNIs is coming soon. See the <a href="https://github.com/coreos/flannel/blob/master/Documentation/backends.md#vxlan" target="_blank">VXLAN documentation</a>
for an explanation of these fields.</div>
</blockquote></li>

<li><p>In the <code>net-conf.json</code> section of your <code>kube-flannel.yml</code>, double-check:</p>

<ol>
<li>The cluster subnet (e.g. &ldquo;10.244.0.0/16&rdquo;) is set as per your IP plan.

<ul>
<li>VNI 4096 is set in the backend</li>
<li>Port 4789 is set in the backend</li>
</ul></li>
<li>In the <code>cni-conf.json</code> section of your <code>kube-flannel.yml</code>, change the network name to <code>vxlan0</code>.</li>
</ol>

<p>Your <code>cni-conf.json</code> should look as follows:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json"><span style="">cni-conf.json:</span> <span style="">|</span>
    {
      <span style="color:#008000;font-weight:bold">&#34;name&#34;</span>: <span style="color:#b44">&#34;vxlan0&#34;</span>,
      <span style="color:#008000;font-weight:bold">&#34;plugins&#34;</span>: [
        {
          <span style="color:#008000;font-weight:bold">&#34;type&#34;</span>: <span style="color:#b44">&#34;flannel&#34;</span>,
          <span style="color:#008000;font-weight:bold">&#34;delegate&#34;</span>: {
            <span style="color:#008000;font-weight:bold">&#34;hairpinMode&#34;</span>: <span style="color:#a2f;font-weight:bold">true</span>,
            <span style="color:#008000;font-weight:bold">&#34;isDefaultGateway&#34;</span>: <span style="color:#a2f;font-weight:bold">true</span>
          }
        },
        {
          <span style="color:#008000;font-weight:bold">&#34;type&#34;</span>: <span style="color:#b44">&#34;portmap&#34;</span>,
          <span style="color:#008000;font-weight:bold">&#34;capabilities&#34;</span>: {
            <span style="color:#008000;font-weight:bold">&#34;portMappings&#34;</span>: <span style="color:#a2f;font-weight:bold">true</span>
          }
        }
      ]
    }</code></pre></div></li>

<li><p>Apply the Flannel yaml and Validate</p>

<p>Let&rsquo;s apply the Flannel configuration:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl apply -f kube-flannel.yml</code></pre></div>
<p>After a few minutes, you should see all the pods as running if the Flannel pod network was deployed.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get pods --all-namespaces</code></pre></div>
<p><img src="../flannel-master-kubeclt-get-pods.png" alt="alt_text" title="flannel master kubectl get pods screen capture" /></p>

<p>Verify that the Flannel DaemonSet has the NodeSelector applied.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get ds -n kube-system</code></pre></div>
<p><img src="../flannel-master-kubectl-get-ds.png" alt="alt_text" title="flannel master kubectl get ds screen capture" /></p></li>
</ol>

<h4 id="join-windows-worker">Join Windows Worker</h4>

<p>In this section we&rsquo;ll cover configuring a Windows node from scratch to join a cluster on-prem. If your cluster is on a cloud you&rsquo;ll likely want to follow the cloud specific guides in the next section.</p>

<h4 id="preparing-a-windows-node">Preparing a Windows Node</h4>

<blockquote class="note">
  <div><strong>備考:</strong> All code snippets in Windows sections are to be run in a PowerShell environment with elevated permissions (Admin).</div>
</blockquote>

<ol>
<li><p>Install Docker (requires a system reboot)</p>

<p>Kubernetes uses <a href="https://www.docker.com/" target="_blank">Docker</a> as its container engine, so we need to install it. You can follow the <a href="https://docs.microsoft.com/en-us/virtualization/windowscontainers/manage-docker/configure-docker-daemon#install-docker" target="_blank">official Docs instructions</a>, the <a href="https://store.docker.com/editions/enterprise/docker-ee-server-windows" target="_blank">Docker instructions</a>, or try the following <em>recommended</em> steps:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-PowerShell" data-lang="PowerShell"><span style="color:#a2f">Enable-WindowsOptionalFeature</span> -FeatureName Containers
<span style="color:#a2f">Restart-Computer</span> -Force
Install-Module -Name DockerMsftProvider -Repository PSGallery -Force
Install-Package -Name Docker -ProviderName DockerMsftProvider</code></pre></div>
<p>If you are behind a proxy, the following PowerShell environment variables must be defined:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-PowerShell" data-lang="PowerShell"><span style="color:#800">[Environment]</span>::SetEnvironmentVariable(<span style="color:#b44">&#34;HTTP_PROXY&#34;</span>, <span style="color:#b44">&#34;http://proxy.example.com:80/&#34;</span>, <span style="color:#800">[EnvironmentVariableTarget]</span>::Machine)
<span style="color:#800">[Environment]</span>::SetEnvironmentVariable(<span style="color:#b44">&#34;HTTPS_PROXY&#34;</span>, <span style="color:#b44">&#34;http://proxy.example.com:443/&#34;</span>, <span style="color:#800">[EnvironmentVariableTarget]</span>::Machine)</code></pre></div>
<p>If after reboot you see the following error, you need to restart the docker service manually</p>

<p><img src="../windows-docker-error.png" alt="alt_text" title="windows docker error screen capture" /></p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-PowerShell" data-lang="PowerShell"><span style="color:#a2f">Start-Service</span> docker</code></pre></div>
<blockquote class="note">
<div><strong>備考:</strong> The &ldquo;pause&rdquo; (infrastructure) image is hosted on Microsoft Container Registry (MCR). You can access it using &ldquo;docker pull mcr.microsoft.com/k8s/core/pause:1.2.0&rdquo;. The DOCKERFILE is available at <a href="https://github.com/kubernetes-sigs/sig-windows-tools/tree/master/cmd/wincat" target="_blank">https://github.com/kubernetes-sigs/sig-windows-tools/tree/master/cmd/wincat</a>.</div>
</blockquote></li>

<li><p>Prepare a Windows directory for Kubernetes</p>

<p>Create a &ldquo;Kubernetes for Windows&rdquo; directory to store Kubernetes binaries as well as any deployment scripts and config files.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-PowerShell" data-lang="PowerShell">mkdir c<span style="">:</span>\k</code></pre></div></li>

<li><p>Copy Kubernetes certificate</p>

<p>Copy the Kubernetes certificate file <code>$HOME/.kube/config</code> <a href="https://docs.microsoft.com/en-us/virtualization/windowscontainers/kubernetes/creating-a-linux-master#collect-cluster-information" target="_blank">from the Linux controller</a> to this new <code>C:\k</code> directory on your Windows node.</p>

<p>Tip: You can use tools such as <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/xcopy" target="_blank">xcopy</a>, <a href="https://winscp.net/eng/download.php" target="_blank">WinSCP</a>, or this <a href="https://www.powershellgallery.com/packages/WinSCP/5.13.2.0" target="_blank">PowerShell wrapper for WinSCP</a> to transfer the config file between nodes.</p></li>

<li><p>Download Kubernetes binaries</p>

<p>To be able to run Kubernetes, you first need to download the <code>kubelet</code> and <code>kube-proxy</code> binaries. You download these from the Node Binaries links in the CHANGELOG.md file of the <a href="https://github.com/kubernetes/kubernetes/releases/" target="_blank">latest releases</a>. For example &lsquo;kubernetes-node-windows-amd64.tar.gz&rsquo;. You may also optionally download <code>kubectl</code> to run on Windows which you can find under Client Binaries.</p>

<p>Use the <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/expand-archive?view=powershell-6" target="_blank">Expand-Archive</a> PowerShell command to extract the archive and place the binaries into <code>C:\k</code>.</p></li>
</ol>

<h4 id="join-the-windows-node-to-the-flannel-cluster">Join the Windows node to the Flannel cluster</h4>

<p>The Flannel overlay deployment scripts and documentation are available in <a href="https://github.com/Microsoft/SDN/tree/master/Kubernetes/flannel/overlay" target="_blank">this repository</a>. The following steps are a simple walkthrough of the more comprehensive instructions available there.</p>

<p>Download the <a href="https://github.com/Microsoft/SDN/blob/master/Kubernetes/flannel/start.ps1" target="_blank">Flannel start.ps1</a> script, the contents of which should be extracted to <code>C:\k</code>:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-PowerShell" data-lang="PowerShell">cd c<span style="">:</span>\k
<span style="color:#800">[Net.ServicePointManager]</span>::SecurityProtocol = <span style="color:#800">[Net.SecurityProtocolType]</span>::Tls12
wget https<span style="">:</span>//raw.githubusercontent.com/Microsoft/SDN/master/Kubernetes/flannel/start.ps1 -o c<span style="">:</span>\k\start.ps1</code></pre></div>
<blockquote class="note">
  <div><strong>備考:</strong> <a href="https://github.com/Microsoft/SDN/blob/master/Kubernetes/flannel/start.ps1" target="_blank">start.ps1</a> references <a href="https://github.com/Microsoft/SDN/blob/master/Kubernetes/windows/install.ps1" target="_blank">install.ps1</a>, which downloads additional files such as the <code>flanneld</code> executable and the <a href="https://github.com/Microsoft/SDN/blob/master/Kubernetes/windows/Dockerfile" target="_blank">Dockerfile for infrastructure pod</a> and install those for you. For overlay networking mode, the <a href="https://github.com/Microsoft/SDN/blob/master/Kubernetes/windows/helper.psm1#L111" target="_blank">firewall</a> is opened for local UDP port 4789. There may be multiple powershell windows being opened/closed as well as a few seconds of network outage while the new external vSwitch for the pod network is being created the first time. Run the script using the arguments as specified below:</div>
</blockquote>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-PowerShell" data-lang="PowerShell">.\start.ps1 -ManagementIP &lt;Windows Node IP&gt; -NetworkMode overlay  -ClusterCIDR &lt;Cluster CIDR&gt; -ServiceCIDR &lt;Service CIDR&gt; -KubeDnsServiceIP &lt;Kube-dns Service IP&gt; -LogDir &lt;Log directory&gt;</code></pre></div>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Default Value</th>
<th>Notes</th>
</tr>
</thead>

<tbody>
<tr>
<td>-ManagementIP</td>
<td>N/A (required)</td>
<td>The IP address assigned to the Windows node. You can use <code>ipconfig</code> to find this.</td>
</tr>

<tr>
<td>-NetworkMode</td>
<td>l2bridge</td>
<td>We&rsquo;re using <code>overlay</code> here</td>
</tr>

<tr>
<td>-ClusterCIDR</td>
<td>10.244.0.0/16</td>
<td>Refer to your cluster IP plan</td>
</tr>

<tr>
<td>-ServiceCIDR</td>
<td>10.96.0.0/12</td>
<td>Refer to your cluster IP plan</td>
</tr>

<tr>
<td>-KubeDnsServiceIP</td>
<td>10.96.0.10</td>
<td></td>
</tr>

<tr>
<td>-InterfaceName</td>
<td>Ethernet</td>
<td>The name of the network interface of the Windows host. You can use <code>ipconfig</code> to find this.</td>
</tr>

<tr>
<td>-LogDir</td>
<td>C:\k</td>
<td>The directory where kubelet and kube-proxy logs are redirected into their respective output files.</td>
</tr>
</tbody>
</table>

<p>Now you can view the Windows nodes in your cluster by running the following:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">kubectl get nodes</code></pre></div>
<blockquote class="note">
  <div><strong>備考:</strong> You may want to configure your Windows node components like kubelet and kube-proxy to run as services. View the services and background processes section under <a href="#troubleshooting">troubleshooting</a> for additional instructions. Once you are running the node components as services, collecting logs becomes an important part of troubleshooting. View the <a href="https://github.com/kubernetes/community/blob/master/sig-windows/CONTRIBUTING.md#gathering-logs" target="_blank">gathering logs</a> section of the contributing guide for further instructions.</div>
</blockquote>

<h3 id="public-cloud-providers">Public Cloud Providers</h3>

<h4 id="azure">Azure</h4>

<p>AKS-Engine can deploy a complete, customizable Kubernetes cluster with both Linux &amp; Windows nodes. There is a step-by-step walkthrough available in the <a href="https://github.com/Azure/aks-engine/blob/master/docs/topics/windows.md" target="_blank">docs on GitHub</a>.</p>

<h4 id="gcp">GCP</h4>

<p>Users can easily deploy a complete Kubernetes cluster on GCE following this step-by-step walkthrough on <a href="https://github.com/kubernetes/kubernetes/blob/master/cluster/gce/windows/README-GCE-Windows-kube-up.md" target="_blank">GitHub</a></p>

<h4 id="deployment-with-kubeadm-and-cluster-api">Deployment with kubeadm and cluster API</h4>

<p>Kubeadm is becoming the de facto standard for users to deploy a Kubernetes cluster. Windows node support in kubeadm will come in a future release. We are also making investments in cluster API to ensure Windows nodes are properly provisioned.</p>

<h3 id="next-steps">Next Steps</h3>

<p>Now that you&rsquo;ve configured a Windows worker in your cluster to run Windows containers you may want to add one or more Linux nodes as well to run Linux containers. You are now ready to schedule Windows containers on your cluster.</p>















    
            
  <h2>フィードバック</h2>
  <p class="feedback--prompt">このページは役に立ちましたか？ </p>
  <button class="button feedback--yes">はい</button>
  <button class="button feedback--no">いいえ</button>
  <p class="feedback--response feedback--response__hidden">
    Thanks for the feedback. If you have a specific, answerable question about how to use Kubernetes, ask it on
    <a target="_blank" rel="noopener"
      href="https://stackoverflow.com/questions/tagged/kubernetes">
      Stack Overflow</a>.
    Open an issue in the GitHub repo if you want to 
    <a class="feedback--link" target="_blank" rel="noopener"
      href="https://github.com/kubernetes/website/issues/new?title=Issue%20with%20k8s.io">
      問題を報告する</a>
    or
    <a class="feedback--link" target="_blank" rel="noopener"
      href="https://github.com/kubernetes/website/issues/new?title=Improvement%20for%20k8s.io">
      改善を提案</a>.
  </p>
  <script>
    const yes = document.querySelector('.feedback--yes');
    const no = document.querySelector('.feedback--no');
    document.querySelectorAll('.feedback--link').forEach(link => {
      link.href = link.href + window.location.pathname;
    });
    const sendFeedback = (value) => {
      if (!gtag) { console.log('!gtag'); }
      gtag('event', 'click', {
        'event_category': 'Helpful',
        'event_label': window.location.pathname,
        value
      });
    };
    const disableButtons = () => {
      yes.disabled = true;
      yes.classList.add('feedback--button__disabled');
      no.disabled = true;
      no.classList.add('feedback--button__disabled');
    };
    yes.addEventListener('click', () => {
      sendFeedback(1);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
    no.addEventListener('click', () => {
      sendFeedback(0);
      disableButtons();
      document.querySelector('.feedback--response').classList.remove('feedback--response__hidden');
    });
  </script>


    
            <div id="pre-footer"> 
  <hr />

  <div class="issue-button-container">
    <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/setup/production-environment/windows/user-guide-windows-nodes.md?pixel" alt="Analytics" /></a></p>
    
    
    <script type="text/javascript">
    PDRTJS_settings_8345992 = {
    "id" : "8345992",
    "unique_id" : "\/ja\/docs\/setup\/production-environment\/windows\/user-guide-windows-nodes\/",
    "title" : "Guide for adding Windows Nodes in Kubernetes",
    "permalink" : "https:\/\/kubernetes.io\/ja\/docs\/setup\/production-environment\/windows\/user-guide-windows-nodes\/"
    };
    (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
    </script>
    <a href="" onclick="window.open('https://github.com/kubernetes/website/issues/new?template=bug-report.md&title=Issue%20with%20' +
    'k8s.io'+window.location.pathname)" class="button issue">Issue作成</a>
    
    
    
    <a href="https://github.com/kubernetes/website/edit/master/content/ja/docs/setup/production-environment/windows/user-guide-windows-nodes.md" class="button issue">ページ編集</a>
    
  </div>
  

  <div id="lastedit" class="lastedit issue-button-container">
    ページの最終更新 December 24, 2019 at 12:11 PM PST by
    <a href="https://github.com/kubernetes/website/commit/9f42b6b743fa3d160b2676c9bab1e1ce2256bd4a/">Remove redundant information when deploy flannel on kubernetes include windows node (#18273)</a> (<a href="https://github.com/kubernetes/website/commits/master/content/en/docs/setup/production-environment/windows/user-guide-windows-nodes.md">ページ履歴</a>)
  </div>
  
</div>

          </div>
        </section>
    </main>
		<footer>
    <div class="light-text main-section">
        <nav>
            
            
            
            <a href="/ja/docs/home/">ホーム</a>
            
            
            
            
            
            
            
            
            
            <a href="/ja/case-studies/">ケーススタディ</a>
            
        </nav>
        <div class="social" role="region" aria-label="Social hyperlinks">
            <div>
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>GitHub</span></a>
                <a href="https://slack.k8s.io/" class="slack"><span>Slack</span></a>
            </div>
            <div>
                <a href="https://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://www.youtube.com/kubernetescommunity" class="youtube"><span>YouTube</span></a>
                <a href="https://discuss.kubernetes.io" class="mailing-list"><span>フォーラム</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>イベントカレンダー</span></a>
            </div>
            <div>
                
                <a href="https://git.k8s.io/community/contributors/guide" class="button">コントリビュート</a>
            </div>
        </div>
        <div class="miceType center">
            &copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href="https://git.k8s.io/website/LICENSE" class="light-text">CC BY 4.0</a></a>
        </div>
        <div class="miceType center">
            Copyright &copy; 2023 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">Trademark Usage page</a>
        </div>
        <div class="miceType center">
            ICP license: 京ICP备17074266号-3
        </div>
    </div>
</footer>

		<button class="flyout-button" onclick="kub.toggleToc()" aria-label="Toggle table of contents visibility"></button>

<script>

(function () {
    window.addEventListener('DOMContentLoaded', init)

        
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
        if (!toc) return
            var container = toc.querySelector('.container')

                
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>



    <script language="application/javascript">
      
      (function addHeadingLinks(){
        var article = document.getElementById('docsContent');
        var headings = article.querySelectorAll('h1, h2, h3, h4, h5, h6');
        headings.forEach(function(heading){
          if(heading.id){
            var a = document.createElement('a');
            a.innerHTML = heading.innerHTML;
            a.href = '#'+heading.id;
            a.classList.add('inpage_heading');
            heading.innerHTML = '';
            heading.appendChild(a);
          }
        });
      })();
    </script>
	</body>
</html>
